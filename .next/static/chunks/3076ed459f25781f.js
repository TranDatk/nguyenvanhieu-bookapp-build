(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,95708,e=>{"use strict";var t=e.i(71645),r=e.i(66027),a=e.i(22342);let i={all:["articles"],lists:()=>[...i.all,"list"],list:e=>[...i.lists(),{filters:e}],details:()=>[...i.all,"detail"],detail:e=>[...i.details(),e]};async function s(){let e=await fetch("/api/articles");if(!e.ok)throw Error("Failed to fetch articles");return e.json()}function n(){let{setArticles:e}=(0,a.useDataStore)(),n=(0,r.useQuery)({queryKey:i.all,queryFn:s});return t.default.useEffect(()=>{n.data&&e(n.data)},[n.data,e]),n}e.s(["useArticles",()=>n])},71689,e=>{"use strict";let t=(0,e.i(75254).default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>t],71689)},72866,e=>{"use strict";var t=e.i(71645),r=e.i(66027),a=e.i(54616),i=e.i(12598),s=e.i(22342);let n=["article-categories"];async function o(){let e=await fetch("/api/article-categories");if(!e.ok)throw Error("Failed to fetch article categories");return e.json()}async function l(e){let t=await fetch("/api/article-categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e})});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Failed to create article category"}))).error||"Failed to create article category")}async function c({oldCategory:e,newCategory:t}){let r=await fetch("/api/article-categories",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldCategory:e,newCategory:t})});if(!r.ok)throw Error((await r.json().catch(()=>({error:"Failed to update article category"}))).error||"Failed to update article category")}async function d(e){let t=await fetch(`/api/article-categories?category=${encodeURIComponent(e)}`,{method:"DELETE"});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Failed to delete article category"}))).error||"Failed to delete article category")}function u(){let{setArticleCategories:e}=(0,s.useDataStore)(),a=(0,r.useQuery)({queryKey:n,queryFn:o});return t.default.useEffect(()=>{a.data&&e(a.data)},[a.data,e]),a}function h(){let e=(0,i.useQueryClient)(),{addArticleCategory:t}=(0,s.useDataStore)();return(0,a.useMutation)({mutationFn:l,onSuccess:(r,a)=>{t(a),e.invalidateQueries({queryKey:n})},onError:e=>{console.error("Failed to create article category:",e)}})}function f(){let e=(0,i.useQueryClient)(),{updateArticleCategory:t}=(0,s.useDataStore)();return(0,a.useMutation)({mutationFn:c,onSuccess:(r,a)=>{t(a.oldCategory,a.newCategory),e.invalidateQueries({queryKey:n})},onError:e=>{console.error("Failed to update article category:",e)}})}function m(){let e=(0,i.useQueryClient)(),{deleteArticleCategory:t}=(0,s.useDataStore)();return(0,a.useMutation)({mutationFn:d,onSuccess:(r,a)=>{t(a),e.invalidateQueries({queryKey:n})},onError:e=>{console.error("Failed to delete article category:",e)}})}e.s(["useArticleCategories",()=>u,"useCreateArticleCategory",()=>h,"useDeleteArticleCategory",()=>m,"useUpdateArticleCategory",()=>f])},97529,e=>{"use strict";let t,r="0123456789abcdef";class a{constructor(e){this.bytes=e}static ofInner(e){if(16===e.length)return new a(e);throw TypeError("not 128-bit length")}static fromFieldsV7(e,t,r,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(r)||!Number.isInteger(i)||e<0||t<0||r<0||i<0||e>0xffffffffffff||t>4095||r>0x3fffffff||i>0xffffffff)throw RangeError("invalid field value");let s=new Uint8Array(16);return s[0]=e/0x10000000000,s[1]=e/0x100000000,s[2]=e/0x1000000,s[3]=e/65536,s[4]=e/256,s[5]=e,s[6]=112|t>>>8,s[7]=t,s[8]=128|r>>>24,s[9]=r>>>16,s[10]=r>>>8,s[11]=r,s[12]=i>>>24,s[13]=i>>>16,s[14]=i>>>8,s[15]=i,new a(s)}static parse(e){var t,r,i,s;let n;switch(e.length){case 32:n=null==(t=/^[0-9a-f]{32}$/i.exec(e))?void 0:t[0];break;case 36:n=null==(r=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(e))?void 0:r.slice(1,6).join("");break;case 38:n=null==(i=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(e))?void 0:i.slice(1,6).join("");break;case 45:n=null==(s=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(e))?void 0:s.slice(1,6).join("")}if(n){let e=new Uint8Array(16);for(let t=0;t<16;t+=4){let r=parseInt(n.substring(2*t,2*t+8),16);e[t+0]=r>>>24,e[t+1]=r>>>16,e[t+2]=r>>>8,e[t+3]=r}return new a(e)}throw SyntaxError("could not parse UUID string")}toString(){let e="";for(let t=0;t<this.bytes.length;t++)e+=r.charAt(this.bytes[t]>>>4),e+=r.charAt(15&this.bytes[t]),(3===t||5===t||7===t||9===t)&&(e+="-");return e}toHex(){let e="";for(let t=0;t<this.bytes.length;t++)e+=r.charAt(this.bytes[t]>>>4),e+=r.charAt(15&this.bytes[t]);return e}toJSON(){return this.toString()}getVariant(){let e=this.bytes[8]>>>4;if(e<0)throw Error("unreachable");if(e<=7)return this.bytes.every(e=>0===e)?"NIL":"VAR_0";if(e<=11)return"VAR_10";if(e<=13)return"VAR_110";if(e<=15)return this.bytes.every(e=>255===e)?"MAX":"VAR_RESERVED";else throw Error("unreachable")}getVersion(){return"VAR_10"===this.getVariant()?this.bytes[6]>>>4:void 0}clone(){return new a(this.bytes.slice(0))}equals(e){return 0===this.compareTo(e)}compareTo(e){for(let t=0;t<16;t++){let r=this.bytes[t]-e.bytes[t];if(0!==r)return Math.sign(r)}return 0}}class i{constructor(e){this.timestamp_biased=0,this.counter=0,this.random=null!=e?e:s()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(e,t){let r=this.generateOrAbortCore(e,t);return void 0===r&&(this.timestamp_biased=0,r=this.generateOrAbortCore(e,t)),r}generateOrAbortCore(e,t){if(!Number.isInteger(e)||e<0||e>0xffffffffffff)throw RangeError("`unixTsMs` must be a 48-bit unsigned integer");if(t<0||t>0xffffffffffff)throw RangeError("`rollbackAllowance` out of reasonable range");if(++e>this.timestamp_biased)this.timestamp_biased=e,this.resetCounter();else{if(!(e+t>=this.timestamp_biased))return;this.counter++,this.counter>0x3ffffffffff&&(this.timestamp_biased++,this.resetCounter())}return a.fromFieldsV7(this.timestamp_biased-1,Math.trunc(this.counter/0x40000000),this.counter&0x40000000-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}generateV4(){let e=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return e[6]=64|e[6]>>>4,e[8]=128|e[8]>>>2,a.ofInner(e)}}let s=()=>{if("undefined"!=typeof crypto&&void 0!==crypto.getRandomValues)return new n;if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");return{nextUint32:()=>65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random())}};class n{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}function o(){return(t||(t=new i)).generate().toString()}e.s(["generateId",()=>o],97529)},69074,e=>{"use strict";let t=(0,e.i(75254).default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);e.s(["Upload",()=>t],69074)},24687,e=>{"use strict";var t=e.i(43476),r=e.i(75157);function a({className:e,...a}){return(0,t.jsx)("textarea",{"data-slot":"textarea",className:(0,r.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}e.s(["Textarea",()=>a])},347,3408,2825,e=>{"use strict";var t=e.i(71645),r=e.i(66027),a=e.i(54616),i=e.i(12598),s=e.i(22342);let n=["book-categories"];async function o(){let e=await fetch("/api/book-categories");if(!e.ok)throw Error("Failed to fetch book categories");return e.json()}async function l(e){let t=await fetch("/api/book-categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:e})});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Failed to create book category"}))).error||"Failed to create book category")}async function c({oldCategory:e,newCategory:t}){let r=await fetch("/api/book-categories",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldCategory:e,newCategory:t})});if(!r.ok)throw Error((await r.json().catch(()=>({error:"Failed to update book category"}))).error||"Failed to update book category")}async function d(e){let t=await fetch(`/api/book-categories?category=${encodeURIComponent(e)}`,{method:"DELETE"});if(!t.ok)throw Error((await t.json().catch(()=>({error:"Failed to delete book category"}))).error||"Failed to delete book category")}function u(){let{setBookCategories:e}=(0,s.useDataStore)(),a=(0,r.useQuery)({queryKey:n,queryFn:o});return t.default.useEffect(()=>{a.data&&e(a.data)},[a.data,e]),a}function h(){let e=(0,i.useQueryClient)(),{addBookCategory:t}=(0,s.useDataStore)();return(0,a.useMutation)({mutationFn:l,onSuccess:(r,a)=>{t(a),e.invalidateQueries({queryKey:n})},onError:e=>{console.error("Failed to create book category:",e)}})}function f(){let e=(0,i.useQueryClient)(),{updateBookCategory:t}=(0,s.useDataStore)();return(0,a.useMutation)({mutationFn:c,onSuccess:(r,a)=>{t(a.oldCategory,a.newCategory),e.invalidateQueries({queryKey:n})},onError:e=>{console.error("Failed to update book category:",e)}})}function m(){let e=(0,i.useQueryClient)(),{deleteBookCategory:t}=(0,s.useDataStore)();return(0,a.useMutation)({mutationFn:d,onSuccess:(r,a)=>{t(a),e.invalidateQueries({queryKey:n})},onError:e=>{console.error("Failed to delete book category:",e)}})}e.s(["useBookCategories",()=>u,"useCreateBookCategory",()=>h,"useDeleteBookCategory",()=>m,"useUpdateBookCategory",()=>f],347);var p=e.i(43476),g=e.i(97529);function y(e){if(0===e)return"0 Bytes";let t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["Bytes","KB","MB","GB"][t]}var x=e.i(19455),v=e.i(46798),b=e.i(75254);let j=(0,b.default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),k=(0,b.default)("file-archive",[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]]),w=(0,b.default)("file-spreadsheet",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var N=e.i(89053),N=N;let C=(0,b.default)("headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),U=(0,b.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);e.s(["default",()=>U],3408);let E=(0,b.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var S=e.i(27612),M=e.i(69074);let F=(0,b.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var A=e.i(95926),T=e.i(75157),D=e.i(46696);function R({maxFiles:e=10,maxSize:r=0x3200000,accept:a="*",multiple:i=!0,className:s,onFilesChange:n,simulateUpload:o=!0,onUploadProgress:l}){let[c,d]=(0,t.useState)([]),{isDragging:u,errors:h,removeFile:f,clearFiles:m,handleDragEnter:b,handleDragLeave:R,handleDragOver:z,handleDrop:L,openFileDialog:_,getInputProps:I}=function({maxFiles:e=10,maxSize:r=0x3200000,accept:a="*",multiple:i=!0,initialFiles:s=[],onFilesChange:n}){let[o,l]=(0,t.useState)(!1),[c,d]=(0,t.useState)([]),[u,h]=(0,t.useState)(()=>s.map(e=>({id:e.id,file:e,preview:e.url||""}))),f=(0,t.useRef)(0),m=(0,t.useRef)(null),p=e=>{if(e.size>r)return`File "${e.name}" vượt qu\xe1 k\xedch thước tối đa ${y(r)}`;if("*"!==a){let t=a.split(",").map(e=>e.trim()),r="."+e.name.split(".").pop()?.toLowerCase(),i=e.type.toLowerCase();if(!t.some(e=>{if(e.includes("/")&&i===e.toLowerCase()||e.startsWith(".")&&r===e.toLowerCase())return!0;if(e.endsWith("/*")){let t=e.split("/")[0];if(i.startsWith(t+"/"))return!0}return!1}))return`File "${e.name}" kh\xf4ng phải l\xe0 định dạng được chấp nhận. Chấp nhận: ${t.join(", ")}`}return null},x=(0,t.useCallback)(async t=>{let r=Array.from(t),a=[],i=[];for(let e of r){let t=p(e);t?a.push(t):i.push(e)}u.length+i.length>e&&(a.push(`Chỉ cho ph\xe9p tối đa ${e} file`),i.splice(e-u.length)),d(a);let s=[...u,...await Promise.all(i.map(async e=>{let t=await new Promise(t=>{if(e.type.startsWith("image/")){let r=new FileReader;r.onload=e=>t(e.target?.result),r.readAsDataURL(e)}else t("")});return{id:(0,g.generateId)(),file:e,preview:t}}))];h(s),n?.(s)},[u,e,r,a,n]),v=(0,t.useCallback)(e=>{let t=u.filter(t=>t.id!==e);h(t),n?.(t)},[u,n]),b=(0,t.useCallback)(()=>{h([]),n?.([])},[n]),j=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),f.current++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&l(!0)},[]),k=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),f.current--,0===f.current&&l(!1)},[]),w=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation()},[]),N=(0,t.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),l(!1),f.current=0,e.dataTransfer.files&&e.dataTransfer.files.length>0&&x(e.dataTransfer.files)},[x]),C=(0,t.useCallback)(()=>{m.current?.click()},[]),U=(0,t.useCallback)(e=>{e.target.files&&e.target.files.length>0&&(x(e.target.files),m.current&&(m.current.value=""))},[x]);return{isDragging:o,errors:c,removeFile:v,clearFiles:b,handleDragEnter:j,handleDragLeave:k,handleDragOver:w,handleDrop:N,openFileDialog:C,getInputProps:(0,t.useCallback)(()=>({ref:m,type:"file",accept:a,multiple:i,onChange:U,style:{display:"none"}}),[a,i,U])}}({maxFiles:e,maxSize:r,accept:a,multiple:i,initialFiles:[],onFilesChange:e=>{let t=e.map(e=>{let t=c.find(t=>t.id===e.id);return t?{...t,...e}:{...e,progress:0,status:"uploading"}});d(t),n?.(t)}});(0,t.useEffect)(()=>{h.length>0&&h.forEach(e=>{D.toast.error(e)})},[h]);let P=(0,t.useRef)(new Map);(0,t.useEffect)(()=>{if(l){window.__cardUploadProgressHandlers||(window.__cardUploadProgressHandlers=new Map);let e=window.__cardUploadProgressHandlers;c.forEach(t=>{if("uploading"===t.status){let r=e=>{d(r=>r.map(r=>r.id!==t.id||"uploading"!==r.status?r:e>=100?{...r,progress:100,status:"completed"}:{...r,progress:e}))};P.current.set(t.id,r),e.set(t.id,r)}});let t=new Set(c.map(e=>e.id));return P.current.forEach((r,a)=>{t.has(a)||(P.current.delete(a),e.delete(a))}),window.__updateCardUploadProgress||(window.__updateCardUploadProgress=(t,r)=>{let a=e.get(t);a&&a(r)}),()=>{c.forEach(t=>{e.delete(t.id)})}}},[c,l]),(0,t.useEffect)(()=>{if(!o||l||0===c.filter(e=>"uploading"===e.status).length)return;let e=setInterval(()=>{d(e=>e.map(e=>{if("uploading"!==e.status)return e;let t=20*Math.random()+5,r=Math.min(e.progress+t,100);if(r>=100){let t=.1>Math.random();return{...e,progress:100,status:t?"error":"completed",error:t?"Tải lên thất bại. Vui lòng thử lại.":void 0}}return{...e,progress:r}}))},500);return()=>clearInterval(e)},[c,o,l]);let B=e=>{let t=(e instanceof File,e.type);return t.startsWith("image/")?(0,p.jsx)(U,{className:"size-6"}):t.startsWith("video/")?(0,p.jsx)(F,{className:"size-6"}):t.startsWith("audio/")?(0,p.jsx)(C,{className:"size-6"}):t.includes("pdf")||t.includes("word")||t.includes("doc")?(0,p.jsx)(N.default,{className:"size-6"}):t.includes("excel")||t.includes("sheet")?(0,p.jsx)(w,{className:"size-6"}):t.includes("zip")||t.includes("rar")?(0,p.jsx)(k,{className:"size-6"}):(0,p.jsx)(N.default,{className:"size-6"})};return(0,p.jsxs)("div",{className:(0,T.cn)("w-full space-y-4",s),children:[(0,p.jsxs)("div",{className:(0,T.cn)("relative rounded-lg border border-dashed p-6 text-center transition-colors",u?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-muted-foreground/50"),onDragEnter:b,onDragLeave:R,onDragOver:z,onDrop:L,children:[(0,p.jsx)("input",{...I(),className:"sr-only"}),(0,p.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,p.jsx)("div",{className:(0,T.cn)("flex h-12 w-12 items-center justify-center rounded-full bg-muted transition-colors",u?"border-primary bg-primary/10":"border-muted-foreground/25"),children:(0,p.jsx)(M.Upload,{className:"h-5 w-5 text-muted-foreground"})}),(0,p.jsxs)("div",{className:"space-y-2",children:[(0,p.jsxs)("p",{className:"text-sm font-medium",children:["Kéo thả file vào đây hoặc"," ",(0,p.jsx)("button",{type:"button",onClick:_,className:"cursor-pointer text-primary underline-offset-4 hover:underline",children:"chọn file"})]}),(0,p.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Kích thước file tối đa: ",y(r)," • Số file tối đa: ",e]})]})]})]}),c.length>0&&(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between",children:[(0,p.jsxs)("h3",{className:"text-sm font-medium",children:["Tệp tin (",c.length,")"]}),e>1&&(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsxs)(x.Button,{onClick:_,variant:"outline",size:"sm",children:[(0,p.jsx)(j,{}),"Thêm file"]}),(0,p.jsxs)(x.Button,{onClick:m,variant:"outline",size:"sm",children:[(0,p.jsx)(S.Trash2,{}),"Xóa tất cả"]})]})]}),(0,p.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3 lg:grid-cols-4",children:c.map(e=>(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsx)(x.Button,{onClick:()=>{var t;let r;return t=e.id,void((r=c.find(e=>e.id===t))&&f(r.id))},variant:"outline",size:"icon",className:"absolute -end-2 -top-2 z-10 size-6 rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:(0,p.jsx)(A.XIcon,{className:"size-3"})}),(0,p.jsxs)("div",{className:"relative overflow-hidden rounded-lg border bg-card transition-colors",children:[(0,p.jsx)("div",{className:"relative aspect-square bg-muted border-b border-border",children:e.file.type.startsWith("image/")&&e.preview?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("img",{src:e.preview,alt:e.file.name,className:"h-full w-full object-cover"}),"uploading"===e.status&&(0,p.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,p.jsx)("div",{className:"relative",children:(0,p.jsxs)("svg",{className:"size-12 -rotate-90",viewBox:"0 0 48 48",children:[(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-muted/60"}),(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${2*Math.PI*20}`,strokeDashoffset:`${2*Math.PI*20*(1-e.progress/100)}`,className:"text-white transition-all duration-300",strokeLinecap:"round"})]})})})]}):(0,p.jsx)("div",{className:"flex h-full items-center justify-center text-muted-foreground/80",children:"uploading"===e.status?(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsxs)("svg",{className:"size-12 -rotate-90",viewBox:"0 0 48 48",children:[(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-muted-foreground/20"}),(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${2*Math.PI*20}`,strokeDashoffset:`${2*Math.PI*20*(1-e.progress/100)}`,className:"text-primary transition-all duration-300",strokeLinecap:"round"})]}),(0,p.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:B(e.file)})]}):(0,p.jsx)("div",{className:"text-4xl",children:B(e.file)})})}),(0,p.jsx)("div",{className:"p-3",children:(0,p.jsxs)("div",{className:"space-y-1",children:[(0,p.jsx)("p",{className:"truncate text-sm font-medium",children:e.file.name}),(0,p.jsxs)("div",{className:"relative flex items-center justify-between gap-2",children:[(0,p.jsx)("span",{className:"text-xs text-muted-foreground",children:y(e.file.size)}),"error"===e.status&&e.error&&(0,p.jsxs)(v.Tooltip,{children:[(0,p.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,p.jsx)(x.Button,{onClick:()=>{var t;return t=e.id,void d(e=>e.map(e=>e.id===t?{...e,progress:0,status:"uploading",error:void 0}:e))},variant:"ghost",size:"icon",className:"absolute end-0 -top-1.25 size-6 text-destructive hover:bg-destructive/10 hover:text-destructive",children:(0,p.jsx)(E,{className:"size-3 opacity-100"})})}),(0,p.jsx)(v.TooltipContent,{children:"Tải lên thất bại. Thử lại"})]})]})]})})]})]},e.id))})]})]})}e.s(["default",()=>R],2825)},84293,e=>{"use strict";var t=e.i(43476),r=e.i(71645),a=e.i(50630),i=e.i(5134),s=e.i(54338),n=e.i(18566),o=e.i(71689),l=e.i(56909),c=e.i(37727),d=e.i(19455),u=e.i(93479),h=e.i(24687),f=e.i(10204),m=e.i(67489),p=e.i(2825),g=e.i(40456),y=e.i(46696);function x(){let{updateArticle:e}=(0,i.useData)(),{isAdmin:x,isLoading:v}=(0,s.useAuth)(),b=(0,n.useRouter)(),j=(0,n.useParams)().id,[k,w]=(0,r.useState)(""),[N,C]=(0,r.useState)(""),[U,E]=(0,r.useState)(""),[S,M]=(0,r.useState)(""),[F,A]=(0,r.useState)(""),[T,D]=(0,r.useState)("published"),[R,z]=(0,r.useState)(!1),[L,_]=(0,r.useState)(!0),[I,P]=(0,r.useState)({}),{articleCategories:B}=(0,i.useData)();if((0,r.useEffect)(()=>{j&&(async()=>{_(!0);try{let e=await fetch("/api/articles");if(!e.ok)throw Error("Failed to fetch article");let t=(await e.json()).find(e=>e.id===j);t?(w(t.title),C(t.category||""),E(t.summary||""),M(t.content||""),A(t.imageUrl||""),D(t.status||"published")):(y.toast.error("Không tìm thấy bài viết"),b.push("/admin/articles"))}catch(e){console.error("Error fetching article:",e),y.toast.error("Không thể tải bài viết"),b.push("/admin/articles")}finally{_(!1)}})()},[j,b]),v||L)return(0,t.jsx)(a.AdminLayout,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-600",children:"Đang tải..."})]})})});if(!x)return(0,t.jsx)(a.AdminLayout,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"bg-white p-8 rounded-lg shadow-sm text-center max-w-md",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-red-500 mb-2",children:"Truy cập bị từ chối"}),(0,t.jsx)("p",{className:"text-slate-600 mb-4",children:"Bạn không có quyền truy cập trang này."}),(0,t.jsx)(d.Button,{onClick:()=>b.push("/login"),children:"Đăng nhập với tài khoản Admin"})]})})});let V=async t=>{let r;if(t.preventDefault(),r={},k&&k.trim()||(r.title="Tiêu đề bài viết là bắt buộc"),S&&S.trim()&&"<p></p>"!==S||(r.content="Nội dung bài viết là bắt buộc"),F&&F.trim()||(r.imageUrl="Hình ảnh bài viết là bắt buộc"),N&&N.trim()||(r.category="Chuyên mục là bắt buộc"),P(r),0!==Object.keys(r).length)return void y.toast.error("Vui lòng điền đầy đủ các trường bắt buộc");z(!0);try{if(!(await fetch("/api/articles",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:j,title:k.trim(),summary:U.trim()||void 0,content:S.trim(),imageUrl:F.trim(),category:N.trim(),status:T})})).ok)throw Error("Failed to update article");await e(j,{title:k.trim(),summary:U.trim()||void 0,content:S.trim(),imageUrl:F.trim(),category:N.trim(),status:T}),y.toast.success("Cập nhật bài viết thành công!"),b.push("/admin/articles")}catch(e){console.error("Error updating article:",e),y.toast.error("Đã có lỗi xảy ra khi cập nhật bài viết.")}finally{z(!1)}},q=async()=>{if(k||S||U||F)try{(await fetch("/api/articles",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:j,title:k.trim()||void 0,summary:U.trim()||void 0,content:S.trim()||void 0,imageUrl:F.trim()||void 0,category:N.trim()||void 0,status:"draft"})})).ok&&(await e(j,{status:"draft"}),y.toast.success("Đã lưu bản nháp!"))}catch(e){console.error("Error saving draft:",e),y.toast.error("Không thể lưu bản nháp")}b.push("/admin/articles")};return(0,t.jsx)(a.AdminLayout,{children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(d.Button,{variant:"ghost",size:"icon",onClick:q,children:(0,t.jsx)(o.ArrowLeft,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Chỉnh sửa bài viết"}),(0,t.jsx)("p",{className:"text-slate-600 mt-1",children:"Cập nhật thông tin và nội dung bài viết"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(d.Button,{variant:"outline",onClick:q,disabled:R,children:[(0,t.jsx)(c.X,{className:"h-4 w-4 mr-2"}),"Hủy"]}),(0,t.jsxs)(d.Button,{onClick:V,disabled:R,children:[(0,t.jsx)(l.Save,{className:"h-4 w-4 mr-2"}),R?"Đang lưu...":"Lưu bài viết"]})]})]}),(0,t.jsx)("form",{onSubmit:V,className:"space-y-6",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f.Label,{htmlFor:"title",children:"Tiêu đề bài viết *"}),(0,t.jsx)(u.Input,{id:"title",type:"text",required:!0,value:k,onChange:e=>{w(e.target.value),I.title&&P(e=>({...e,title:""}))},placeholder:"Nhập tiêu đề bài viết...",className:`text-lg ${I.title?"border-red-500":""}`}),I.title&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:I.title})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f.Label,{htmlFor:"content",children:"Nội dung bài viết *"}),(0,t.jsx)("div",{className:I.content?"border border-red-500 rounded-md":"",children:(0,t.jsx)(g.RichTextEditor,{content:S,onChange:e=>{M(e),I.content&&P(e=>({...e,content:""}))},placeholder:"Nhập nội dung bài viết...",className:"min-h-[500px]"})}),I.content&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:I.content})]})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f.Label,{htmlFor:"category",children:"Chuyên mục *"}),(0,t.jsxs)(m.Select,{value:N,onValueChange:e=>{C(e),I.category&&P(e=>({...e,category:""}))},children:[(0,t.jsx)(m.SelectTrigger,{id:"category",className:I.category?"border-red-500":"",children:(0,t.jsx)(m.SelectValue,{placeholder:"Chọn chuyên mục..."})}),(0,t.jsx)(m.SelectContent,{children:B.map(e=>(0,t.jsx)(m.SelectItem,{value:e,children:e},e))})]}),I.category&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:I.category})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f.Label,{htmlFor:"summary",children:"Mô tả ngắn"}),(0,t.jsx)(h.Textarea,{id:"summary",value:U,onChange:e=>E(e.target.value),rows:4,placeholder:"Nhập mô tả ngắn về bài viết..."}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Mô tả này sẽ được hiển thị trong danh sách bài viết"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(f.Label,{htmlFor:"image",children:"Hình ảnh bài viết *"}),(0,t.jsx)(p.default,{maxFiles:1,maxSize:5242880,accept:"image/*",multiple:!1,onFilesChange:e=>{if(e.length>0&&"completed"===e[0].status){let t=e[0].file;t instanceof File?(A(URL.createObjectURL(t)),I.imageUrl&&P(e=>({...e,imageUrl:""}))):"url"in t&&t.url&&(A(t.url),I.imageUrl&&P(e=>({...e,imageUrl:""})))}else 0===e.length&&A("")},simulateUpload:!0}),(0,t.jsx)(u.Input,{id:"image",type:"text",value:F,onChange:e=>{A(e.target.value),I.imageUrl&&P(e=>({...e,imageUrl:""}))},placeholder:"Hoặc nhập URL hình ảnh",className:`mt-2 ${I.imageUrl?"border-red-500":""}`}),I.imageUrl&&(0,t.jsx)("p",{className:"text-sm text-red-500",children:I.imageUrl})]})]})]})})]})})}e.s(["default",()=>x])}]);