(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26622,e=>{"use strict";let t=(0,e.i(25578).default)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);e.s(["BookOpen",()=>t],26622)},79353,87174,4584,13354,e=>{"use strict";let t;var s=e.i(62769),r=e.i(6218),i=e.i(71369),a=e.i(25533),n=e.i(79701),l=e.i(29843),o=e.i(97754),c=class extends a.Subscribable{constructor(e,t){super(),this.options=t,this.#e=e,this.#t=null,this.#s=(0,n.pendingThenable)(),this.bindMethods(),this.setOptions(t)}#e;#r=void 0;#i=void 0;#a=void 0;#n;#l;#s;#t;#o;#c;#u;#d;#h;#f;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){1===this.listeners.size&&(this.#r.addObserver(this),u(this.#r,this.options)?this.#p():this.updateResult(),this.#x())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return d(this.#r,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return d(this.#r,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#b(),this.#g(),this.#r.removeObserver(this)}setOptions(e){let t=this.options,s=this.#r;if(this.options=this.#e.defaultQueryOptions(e),void 0!==this.options.enabled&&"boolean"!=typeof this.options.enabled&&"function"!=typeof this.options.enabled&&"boolean"!=typeof(0,l.resolveEnabled)(this.options.enabled,this.#r))throw Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#y(),this.#r.setOptions(this.options),t._defaulted&&!(0,l.shallowEqualObjects)(this.options,t)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#r,observer:this});let r=this.hasListeners();r&&h(this.#r,s,this.options,t)&&this.#p(),this.updateResult(),r&&(this.#r!==s||(0,l.resolveEnabled)(this.options.enabled,this.#r)!==(0,l.resolveEnabled)(t.enabled,this.#r)||(0,l.resolveStaleTime)(this.options.staleTime,this.#r)!==(0,l.resolveStaleTime)(t.staleTime,this.#r))&&this.#v();let i=this.#w();r&&(this.#r!==s||(0,l.resolveEnabled)(this.options.enabled,this.#r)!==(0,l.resolveEnabled)(t.enabled,this.#r)||i!==this.#f)&&this.#j(i)}getOptimisticResult(e){var t,s;let r=this.#e.getQueryCache().build(this.#e,e),i=this.createResult(r,e);return t=this,s=i,(0,l.shallowEqualObjects)(t.getCurrentResult(),s)||(this.#a=i,this.#l=this.options,this.#n=this.#r.state),i}getCurrentResult(){return this.#a}trackResult(e,t){return new Proxy(e,{get:(e,s)=>(this.trackProp(s),t?.(s),"promise"===s&&(this.trackProp("data"),this.options.experimental_prefetchInRender||"pending"!==this.#s.status||this.#s.reject(Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,s))})}trackProp(e){this.#m.add(e)}getCurrentQuery(){return this.#r}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){let t=this.#e.defaultQueryOptions(e),s=this.#e.getQueryCache().build(this.#e,t);return s.fetch().then(()=>this.createResult(s,t))}fetch(e){return this.#p({...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#a))}#p(e){this.#y();let t=this.#r.fetch(this.options,e);return e?.throwOnError||(t=t.catch(l.noop)),t}#v(){this.#b();let e=(0,l.resolveStaleTime)(this.options.staleTime,this.#r);if(l.isServer||this.#a.isStale||!(0,l.isValidTimeout)(e))return;let t=(0,l.timeUntilStale)(this.#a.dataUpdatedAt,e);this.#d=o.timeoutManager.setTimeout(()=>{this.#a.isStale||this.updateResult()},t+1)}#w(){return("function"==typeof this.options.refetchInterval?this.options.refetchInterval(this.#r):this.options.refetchInterval)??!1}#j(e){this.#g(),this.#f=e,!l.isServer&&!1!==(0,l.resolveEnabled)(this.options.enabled,this.#r)&&(0,l.isValidTimeout)(this.#f)&&0!==this.#f&&(this.#h=o.timeoutManager.setInterval(()=>{(this.options.refetchIntervalInBackground||s.focusManager.isFocused())&&this.#p()},this.#f))}#x(){this.#v(),this.#j(this.#w())}#b(){this.#d&&(o.timeoutManager.clearTimeout(this.#d),this.#d=void 0)}#g(){this.#h&&(o.timeoutManager.clearInterval(this.#h),this.#h=void 0)}createResult(e,t){let s,r=this.#r,a=this.options,o=this.#a,c=this.#n,d=this.#l,m=e!==r?e.state:this.#i,{state:p}=e,x={...p},b=!1;if(t._optimisticResults){let s=this.hasListeners(),n=!s&&u(e,t),l=s&&h(e,r,t,a);(n||l)&&(x={...x,...(0,i.fetchState)(p.data,e.options)}),"isRestoring"===t._optimisticResults&&(x.fetchStatus="idle")}let{error:g,errorUpdatedAt:y,status:v}=x;s=x.data;let w=!1;if(void 0!==t.placeholderData&&void 0===s&&"pending"===v){let e;o?.isPlaceholderData&&t.placeholderData===d?.placeholderData?(e=o.data,w=!0):e="function"==typeof t.placeholderData?t.placeholderData(this.#u?.state.data,this.#u):t.placeholderData,void 0!==e&&(v="success",s=(0,l.replaceData)(o?.data,e,t),b=!0)}if(t.select&&void 0!==s&&!w)if(o&&s===c?.data&&t.select===this.#o)s=this.#c;else try{this.#o=t.select,s=t.select(s),s=(0,l.replaceData)(o?.data,s,t),this.#c=s,this.#t=null}catch(e){this.#t=e}this.#t&&(g=this.#t,s=this.#c,y=Date.now(),v="error");let j="fetching"===x.fetchStatus,R="pending"===v,k="error"===v,N=R&&j,C=void 0!==s,S={status:v,fetchStatus:x.fetchStatus,isPending:R,isSuccess:"success"===v,isError:k,isInitialLoading:N,isLoading:N,data:s,dataUpdatedAt:x.dataUpdatedAt,error:g,errorUpdatedAt:y,failureCount:x.fetchFailureCount,failureReason:x.fetchFailureReason,errorUpdateCount:x.errorUpdateCount,isFetched:x.dataUpdateCount>0||x.errorUpdateCount>0,isFetchedAfterMount:x.dataUpdateCount>m.dataUpdateCount||x.errorUpdateCount>m.errorUpdateCount,isFetching:j,isRefetching:j&&!R,isLoadingError:k&&!C,isPaused:"paused"===x.fetchStatus,isPlaceholderData:b,isRefetchError:k&&C,isStale:f(e,t),refetch:this.refetch,promise:this.#s,isEnabled:!1!==(0,l.resolveEnabled)(t.enabled,e)};if(this.options.experimental_prefetchInRender){let t=e=>{"error"===S.status?e.reject(S.error):void 0!==S.data&&e.resolve(S.data)},s=()=>{t(this.#s=S.promise=(0,n.pendingThenable)())},i=this.#s;switch(i.status){case"pending":e.queryHash===r.queryHash&&t(i);break;case"fulfilled":("error"===S.status||S.data!==i.value)&&s();break;case"rejected":("error"!==S.status||S.error!==i.reason)&&s()}}return S}updateResult(){let e=this.#a,t=this.createResult(this.#r,this.options);if(this.#n=this.#r.state,this.#l=this.options,void 0!==this.#n.data&&(this.#u=this.#r),(0,l.shallowEqualObjects)(t,e))return;this.#a=t;let s=()=>{if(!e)return!0;let{notifyOnChangeProps:t}=this.options,s="function"==typeof t?t():t;if("all"===s||!s&&!this.#m.size)return!0;let r=new Set(s??this.#m);return this.options.throwOnError&&r.add("error"),Object.keys(this.#a).some(t=>this.#a[t]!==e[t]&&r.has(t))};this.#R({listeners:s()})}#y(){let e=this.#e.getQueryCache().build(this.#e,this.options);if(e===this.#r)return;let t=this.#r;this.#r=e,this.#i=e.state,this.hasListeners()&&(t?.removeObserver(this),e.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#x()}#R(e){r.notifyManager.batch(()=>{e.listeners&&this.listeners.forEach(e=>{e(this.#a)}),this.#e.getQueryCache().notify({query:this.#r,type:"observerResultsUpdated"})})}};function u(e,t){return!1!==(0,l.resolveEnabled)(t.enabled,e)&&void 0===e.state.data&&("error"!==e.state.status||!1!==t.retryOnMount)||void 0!==e.state.data&&d(e,t,t.refetchOnMount)}function d(e,t,s){if(!1!==(0,l.resolveEnabled)(t.enabled,e)&&"static"!==(0,l.resolveStaleTime)(t.staleTime,e)){let r="function"==typeof s?s(e):s;return"always"===r||!1!==r&&f(e,t)}return!1}function h(e,t,s,r){return(e!==t||!1===(0,l.resolveEnabled)(r.enabled,e))&&(!s.suspense||"error"!==e.state.status)&&f(e,s)}function f(e,t){return!1!==(0,l.resolveEnabled)(t.enabled,e)&&e.isStaleByTime((0,l.resolveStaleTime)(t.staleTime,e))}e.s(["QueryObserver",()=>c],87174),e.i(75166);var m=e.i(90223),p=e.i(98177);e.i(70470);var x=m.createContext((t=!1,{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t})),b=m.createContext(!1);b.Provider;var g=(e,t,s)=>t.fetchOptimistic(e).catch(()=>{s.clearReset()});function y(e,t,s){let i=m.useContext(b),a=m.useContext(x),n=(0,p.useQueryClient)(s),o=n.defaultQueryOptions(e);if(n.getDefaultOptions().queries?._experimental_beforeQuery?.(o),o._optimisticResults=i?"isRestoring":"optimistic",o.suspense){let e=e=>"static"===e?e:Math.max(e??1e3,1e3),t=o.staleTime;o.staleTime="function"==typeof t?(...s)=>e(t(...s)):e(t),"number"==typeof o.gcTime&&(o.gcTime=Math.max(o.gcTime,1e3))}(o.suspense||o.throwOnError||o.experimental_prefetchInRender)&&!a.isReset()&&(o.retryOnMount=!1),m.useEffect(()=>{a.clearReset()},[a]);let c=!n.getQueryCache().get(o.queryHash),[u]=m.useState(()=>new t(n,o)),d=u.getOptimisticResult(o),h=!i&&!1!==e.subscribed;if(m.useSyncExternalStore(m.useCallback(e=>{let t=h?u.subscribe(r.notifyManager.batchCalls(e)):l.noop;return u.updateResult(),t},[u,h]),()=>u.getCurrentResult(),()=>u.getCurrentResult()),m.useEffect(()=>{u.setOptions(o)},[o,u]),o?.suspense&&d.isPending)throw g(o,u,a);if((({result:e,errorResetBoundary:t,throwOnError:s,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&void 0===e.data||(0,l.shouldThrowError)(s,[e.error,r])))({result:d,errorResetBoundary:a,throwOnError:o.throwOnError,query:n.getQueryCache().get(o.queryHash),suspense:o.suspense}))throw d.error;if(n.getDefaultOptions().queries?._experimental_afterQuery?.(o,d),o.experimental_prefetchInRender&&!l.isServer&&d.isLoading&&d.isFetching&&!i){let e=c?g(o,u,a):n.getQueryCache().get(o.queryHash)?.promise;e?.catch(l.noop).finally(()=>{u.updateResult()})}return o.notifyOnChangeProps?d:u.trackResult(d)}function v(e,t){return y(e,c,t)}e.s(["useBaseQuery",()=>y],4584),e.s(["useQuery",()=>v],79353);let w=(0,e.i(22103).create)(e=>({books:[],articles:[],practices:[],bookCategories:[],articleCategories:[],setBooks:t=>e({books:t}),addBook:t=>e(e=>({books:[t,...e.books]})),updateBook:(t,s)=>e(e=>({books:e.books.map(e=>e.id===t?{...e,...s}:e)})),deleteBook:t=>e(e=>({books:e.books.filter(e=>e.id!==t)})),setArticles:t=>e({articles:t}),addArticle:t=>e(e=>({articles:[t,...e.articles]})),updateArticle:(t,s)=>e(e=>({articles:e.articles.map(e=>e.id===t?{...e,...s}:e)})),deleteArticle:t=>e(e=>({articles:e.articles.filter(e=>e.id!==t)})),setPractices:t=>e({practices:t}),addPractice:t=>e(e=>({practices:[t,...e.practices]})),updatePractice:(t,s)=>e(e=>({practices:e.practices.map(e=>e.id===t?{...e,...s}:e)})),deletePractice:t=>e(e=>({practices:e.practices.filter(e=>e.id!==t)})),addComment:(t,s)=>e(e=>({books:e.books.map(e=>e.id===t?{...e,comments:[s,...e.comments]}:e)})),setBookCategories:t=>e({bookCategories:t}),addBookCategory:t=>e(e=>e.bookCategories.includes(t)?e:{bookCategories:[...e.bookCategories,t]}),updateBookCategory:(t,s)=>e(e=>{let r=e.bookCategories.indexOf(t);if(-1===r)return e;let i=[...e.bookCategories];return i[r]=s,{bookCategories:i}}),deleteBookCategory:t=>e(e=>({bookCategories:e.bookCategories.filter(e=>e!==t)})),setArticleCategories:t=>e({articleCategories:t}),addArticleCategory:t=>e(e=>e.articleCategories.includes(t)?e:{articleCategories:[...e.articleCategories,t]}),updateArticleCategory:(t,s)=>e(e=>{let r=e.articleCategories.indexOf(t);if(-1===r)return e;let i=[...e.articleCategories];return i[r]=s,{articleCategories:i}}),deleteArticleCategory:t=>e(e=>({articleCategories:e.articleCategories.filter(e=>e!==t)}))}));e.s(["useDataStore",0,w],13354)},75171,e=>{"use strict";var t=e.i(90223),s=e.i(79353),r=e.i(13354);let i={all:["books"],lists:()=>[...i.all,"list"],list:e=>[...i.lists(),{filters:e}],details:()=>[...i.all,"detail"],detail:e=>[...i.details(),e]};async function a(){let e=await fetch("/api/books");if(!e.ok)throw Error("Failed to fetch books");return e.json()}async function n(e){let t=new URLSearchParams;e.page&&t.append("page",e.page.toString()),e.limit&&t.append("limit",e.limit.toString()),e.search&&t.append("search",e.search),e.category&&t.append("category",e.category);let s=await fetch(`/api/books?${t.toString()}`);if(!s.ok)throw Error("Failed to fetch books");return s.json()}function l(){let{setBooks:e}=(0,r.useDataStore)(),n=(0,s.useQuery)({queryKey:i.all,queryFn:a});return t.default.useEffect(()=>{n.data&&e(n.data)},[n.data,e]),n}function o(e){return(0,s.useQuery)({queryKey:[...i.all,"paginated",e],queryFn:()=>n(e)})}e.s(["bookKeys",0,i,"useBooks",()=>l,"useBooksPaginated",()=>o])},6601,e=>{"use strict";let t=(0,e.i(25578).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);e.s(["MessageSquare",()=>t],6601)},25839,e=>{"use strict";let t=(0,e.i(25578).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],25839)},70059,e=>{"use strict";let t,s="0123456789abcdef";class r{constructor(e){this.bytes=e}static ofInner(e){if(16===e.length)return new r(e);throw TypeError("not 128-bit length")}static fromFieldsV7(e,t,s,i){if(!Number.isInteger(e)||!Number.isInteger(t)||!Number.isInteger(s)||!Number.isInteger(i)||e<0||t<0||s<0||i<0||e>0xffffffffffff||t>4095||s>0x3fffffff||i>0xffffffff)throw RangeError("invalid field value");let a=new Uint8Array(16);return a[0]=e/0x10000000000,a[1]=e/0x100000000,a[2]=e/0x1000000,a[3]=e/65536,a[4]=e/256,a[5]=e,a[6]=112|t>>>8,a[7]=t,a[8]=128|s>>>24,a[9]=s>>>16,a[10]=s>>>8,a[11]=s,a[12]=i>>>24,a[13]=i>>>16,a[14]=i>>>8,a[15]=i,new r(a)}static parse(e){var t,s,i,a;let n;switch(e.length){case 32:n=null==(t=/^[0-9a-f]{32}$/i.exec(e))?void 0:t[0];break;case 36:n=null==(s=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(e))?void 0:s.slice(1,6).join("");break;case 38:n=null==(i=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(e))?void 0:i.slice(1,6).join("");break;case 45:n=null==(a=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(e))?void 0:a.slice(1,6).join("")}if(n){let e=new Uint8Array(16);for(let t=0;t<16;t+=4){let s=parseInt(n.substring(2*t,2*t+8),16);e[t+0]=s>>>24,e[t+1]=s>>>16,e[t+2]=s>>>8,e[t+3]=s}return new r(e)}throw SyntaxError("could not parse UUID string")}toString(){let e="";for(let t=0;t<this.bytes.length;t++)e+=s.charAt(this.bytes[t]>>>4),e+=s.charAt(15&this.bytes[t]),(3===t||5===t||7===t||9===t)&&(e+="-");return e}toHex(){let e="";for(let t=0;t<this.bytes.length;t++)e+=s.charAt(this.bytes[t]>>>4),e+=s.charAt(15&this.bytes[t]);return e}toJSON(){return this.toString()}getVariant(){let e=this.bytes[8]>>>4;if(e<0)throw Error("unreachable");if(e<=7)return this.bytes.every(e=>0===e)?"NIL":"VAR_0";if(e<=11)return"VAR_10";if(e<=13)return"VAR_110";if(e<=15)return this.bytes.every(e=>255===e)?"MAX":"VAR_RESERVED";else throw Error("unreachable")}getVersion(){return"VAR_10"===this.getVariant()?this.bytes[6]>>>4:void 0}clone(){return new r(this.bytes.slice(0))}equals(e){return 0===this.compareTo(e)}compareTo(e){for(let t=0;t<16;t++){let s=this.bytes[t]-e.bytes[t];if(0!==s)return Math.sign(s)}return 0}}class i{constructor(e){this.timestamp_biased=0,this.counter=0,this.random=null!=e?e:a()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(e,t){let s=this.generateOrAbortCore(e,t);return void 0===s&&(this.timestamp_biased=0,s=this.generateOrAbortCore(e,t)),s}generateOrAbortCore(e,t){if(!Number.isInteger(e)||e<0||e>0xffffffffffff)throw RangeError("`unixTsMs` must be a 48-bit unsigned integer");if(t<0||t>0xffffffffffff)throw RangeError("`rollbackAllowance` out of reasonable range");if(++e>this.timestamp_biased)this.timestamp_biased=e,this.resetCounter();else{if(!(e+t>=this.timestamp_biased))return;this.counter++,this.counter>0x3ffffffffff&&(this.timestamp_biased++,this.resetCounter())}return r.fromFieldsV7(this.timestamp_biased-1,Math.trunc(this.counter/0x40000000),this.counter&0x40000000-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}generateV4(){let e=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return e[6]=64|e[6]>>>4,e[8]=128|e[8]>>>2,r.ofInner(e)}}let a=()=>{if("undefined"!=typeof crypto&&void 0!==crypto.getRandomValues)return new n;if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");return{nextUint32:()=>65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random())}};class n{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}function l(){return(t||(t=new i)).generate().toString()}e.s(["generateId",()=>l],70059)},77548,e=>{"use strict";var t=e.i(77325);e.s(["Loader2",()=>t.default])},91303,e=>{"use strict";let t=(0,e.i(25578).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],91303)},65113,e=>{"use strict";let t=(0,e.i(25578).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],65113)},51236,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"BailoutToCSR",{enumerable:!0,get:function(){return i}});let r=e.r(29158);function i({reason:e,children:t}){if("undefined"==typeof window)throw Object.defineProperty(new r.BailoutToCSRError(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return t}},56962,(e,t,s)=>{"use strict";function r(e){return e.split("/").map(e=>encodeURIComponent(e)).join("/")}Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"encodeURIPath",{enumerable:!0,get:function(){return r}})},30150,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"PreloadChunks",{enumerable:!0,get:function(){return o}});let r=e.r(70470),i=e.r(304),a=e.r(36701),n=e.r(56962),l=e.r(346);function o({moduleIds:e}){if("undefined"!=typeof window)return null;let t=a.workAsyncStorage.getStore();if(void 0===t)return null;let s=[];if(t.reactLoadableManifest&&e){let r=t.reactLoadableManifest;for(let t of e){if(!r[t])continue;let e=r[t].files;s.push(...e)}}if(0===s.length)return null;let o=(0,l.getDeploymentIdQueryOrEmptyString)();return(0,r.jsx)(r.Fragment,{children:s.map(e=>{let s=`${t.assetPrefix}/_next/${(0,n.encodeURIPath)(e)}${o}`;return e.endsWith(".css")?(0,r.jsx)("link",{precedence:"dynamic",href:s,rel:"stylesheet",as:"style",nonce:t.nonce},e):((0,i.preload)(s,{as:"script",fetchPriority:"low",nonce:t.nonce}),null)})})}},94932,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return c}});let r=e.r(70470),i=e.r(90223),a=e.r(51236),n=e.r(30150);function l(e){return{default:e&&"default"in e?e.default:e}}let o={loader:()=>Promise.resolve(l(()=>null)),loading:null,ssr:!0},c=function(e){let t={...o,...e},s=(0,i.lazy)(()=>t.loader().then(l)),c=t.loading;function u(e){let l=c?(0,r.jsx)(c,{isLoading:!0,pastDelay:!0,error:null}):null,o=!t.ssr||!!t.loading,u=o?i.Suspense:i.Fragment,d=t.ssr?(0,r.jsxs)(r.Fragment,{children:["undefined"==typeof window?(0,r.jsx)(n.PreloadChunks,{moduleIds:t.modules}):null,(0,r.jsx)(s,{...e})]}):(0,r.jsx)(a.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(s,{...e})});return(0,r.jsx)(u,{...o?{fallback:l}:{},children:d})}return u.displayName="LoadableComponent",u}},68175,(e,t,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return i}});let r=e.r(49322)._(e.r(94932));function i(e,t){let s={};"function"==typeof e&&(s.loader=e);let i={...s,...t};return(0,r.default)({...i,modules:i.loadableGenerated?.modules})}("function"==typeof s.default||"object"==typeof s.default&&null!==s.default)&&void 0===s.default.__esModule&&(Object.defineProperty(s.default,"__esModule",{value:!0}),Object.assign(s.default,s),t.exports=s.default)},55751,e=>{"use strict";var t=e.i(70470),s=e.i(90223),r=e.i(92658),i=e.i(81950),a=e.i(68175),n=e.i(75171),l=e.i(13354),o=e.i(91303),c=e.i(56117),u=e.i(6601),d=e.i(65113),h=e.i(26622),f=e.i(17994),m=e.i(77548),p=e.i(25839),x=e.i(70059),b=e.i(72912);let g=(0,a.default)(()=>e.A(21993),{loadableGenerated:{modules:[36854]},ssr:!1,loading:()=>(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)(m.Loader2,{size:48,className:"animate-spin text-yellow-500"})})});function y(){let{id:e}=(0,r.useParams)(),{data:a=[],isLoading:y,refetch:v}=(0,n.useBooks)(),w=(0,l.useDataStore)(),j=a.find(t=>t.id===e)||w.books.find(t=>t.id===e),[R,k]=(0,s.useState)(""),[N,C]=(0,s.useState)(""),[S,O]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{if(!j?.id)return;let e=new Date().toISOString().split("T")[0],t=`book_view_${j.id}_${e}`;localStorage.getItem(t)||(localStorage.setItem(t,"true"),fetch(`/api/books/${j.id}/view`,{method:"POST"}).then(async e=>{if(e.ok)return e.json();throw Error((await e.json().catch(()=>({}))).error||`Failed to increment views: ${e.status} ${e.statusText}`)}).then(e=>{void 0!==e.views&&(w.updateBook(j.id,{views:e.views}),v())}).catch(()=>{localStorage.removeItem(t)}))},[j?.id]),y)return(0,t.jsx)("div",{className:"bg-white min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(m.Loader2,{size:48,className:"animate-spin text-[#d4af37] mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-slate-600 text-lg",children:"Đang tải thông tin sách..."})]})});if(!j)return(0,t.jsx)("div",{className:"bg-white min-h-screen flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center p-20",children:[(0,t.jsx)(h.BookOpen,{size:64,className:"mx-auto mb-4 text-slate-300"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-800 mb-2",children:"Không tìm thấy sách"}),(0,t.jsx)("p",{className:"text-slate-600 mb-6",children:"Cuốn sách bạn đang tìm có thể không tồn tại hoặc đã bị xóa."}),(0,t.jsx)(i.default,{href:"/books",className:"inline-block bg-[#0f294d] text-white px-6 py-2 rounded hover:bg-slate-800 transition-colors",children:"Quay lại danh sách sách"})]})});let I=async e=>{if(e.preventDefault(),!R.trim()||!N.trim()||!j)return;let t={id:(0,x.generateId)(),user:R,content:N,date:new Date().toISOString()};try{let e=await fetch("/api/comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:j.id,comment:t})});if(e.ok)w.addComment(j.id,t),await v(),k(""),C("");else{let t=(await e.json().catch(()=>({}))).error||`Failed to add comment: ${e.status} ${e.statusText}`;throw Error(t)}}catch(e){window.toast&&window.toast.error(e instanceof Error?e.message:"Không thể thêm bình luận")}},E=j?{"@context":"https://schema.org","@type":"Book",name:j.title,author:{"@type":"Person",name:j.author},description:j.description||`S\xe1ch "${j.title}" của t\xe1c giả ${j.author}`,image:j.coverUrl,url:`https://songcunghieu.vn//books/${j.id}`,datePublished:j.publishDate,genre:j.category,aggregateRating:j.comments&&j.comments.length>0?{"@type":"AggregateRating",ratingValue:"5",reviewCount:j.comments.length.toString()}:void 0}:null;return(0,t.jsxs)("div",{className:"bg-white min-h-screen pb-20",children:[E&&(0,t.jsx)(b.StructuredData,{data:E}),(0,t.jsx)("div",{className:"bg-slate-50 border-b border-slate-200 py-3 sm:py-4",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 text-xs sm:text-sm text-slate-500",children:[(0,t.jsx)(i.default,{href:"/",className:"hover:text-[#0f294d]",children:"Trang chủ"})," /",(0,t.jsx)(i.default,{href:"/books",className:"hover:text-[#0f294d] mx-1",children:"Sách"})," /",(0,t.jsx)("span",{className:"text-slate-800 ml-1 font-medium line-clamp-1",children:j.title})]})}),(0,t.jsx)("div",{className:"container mx-auto px-4 sm:px-6 py-8 sm:py-12",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-8 sm:gap-10 md:gap-12 mb-12 sm:mb-20",children:[(0,t.jsx)("div",{className:"md:w-1/3 lg:w-1/4",children:(0,t.jsxs)("div",{className:"md:sticky md:top-24 w-full md:w-[236px] mx-auto md:mx-0",children:[(0,t.jsx)("div",{className:"rounded-sm shadow-2xl overflow-hidden border-4 border-white w-full h-[320px] sm:h-[360px] md:h-[350px] bg-slate-100 flex items-center justify-center",children:(0,t.jsx)("img",{src:j.coverUrl,alt:j.title,className:"w-full h-full object-contain"})}),(0,t.jsxs)("button",{onClick:()=>O(!0),disabled:!j.pdfUrl,className:`w-full mt-4 sm:mt-6 py-2.5 sm:py-3 rounded font-bold uppercase tracking-wide shadow-lg flex items-center justify-center gap-2 transition-colors text-xs sm:text-sm md:text-base ${j.pdfUrl?"bg-[#d4af37] text-white hover:bg-yellow-600 shadow-[#d4af37]/20 cursor-pointer":"bg-slate-200 text-slate-400 cursor-not-allowed"}`,children:[(0,t.jsx)(h.BookOpen,{size:18,className:"sm:w-5 sm:h-5"}),(0,t.jsx)("span",{className:"whitespace-nowrap",children:j.pdfUrl?"Đọc online":"Chưa có bản đọc"})]})]})}),(0,t.jsxs)("div",{className:"md:w-2/3 lg:w-3/4",children:[(0,t.jsx)("div",{className:"mb-3 sm:mb-4",children:(0,t.jsx)("span",{className:"bg-[#0f294d]/5 text-[#0f294d] px-2.5 sm:px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider",children:j.category})}),(0,t.jsx)("h1",{className:"font-serif text-2xl sm:text-3xl md:text-4xl font-bold text-slate-900 mb-3 sm:mb-4 leading-tight",children:j.title}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap sm:items-center gap-2 sm:gap-3 md:gap-4 lg:gap-6 text-slate-500 text-xs sm:text-sm mb-6 sm:mb-8 border-b border-slate-100 pb-6 sm:pb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[(0,t.jsx)(c.User,{size:14,className:"sm:w-4 sm:h-4"}),(0,t.jsx)("span",{className:"font-medium text-slate-700 truncate max-w-[200px] sm:max-w-none",children:j.author})]}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"•"}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[(0,t.jsx)(o.Calendar,{size:14,className:"sm:w-4 sm:h-4"}),(0,t.jsx)("span",{className:"whitespace-nowrap text-xs sm:text-sm",children:(e=>{try{let t=new Date(e),s=t.getDate(),r=t.getMonth()+1,i=t.getFullYear();return`Ng\xe0y ${s} ${["tháng 1","tháng 2","tháng 3","tháng 4","tháng 5","tháng 6","tháng 7","tháng 8","tháng 9","tháng 10","tháng 11","tháng 12"][r-1]} năm ${i}`}catch{return e}})(j.publishDate)})]}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"•"}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[(0,t.jsx)(u.MessageSquare,{size:14,className:"sm:w-4 sm:h-4"}),(0,t.jsxs)("span",{children:[j.comments.length," bình luận"]})]}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"•"}),(0,t.jsxs)("div",{className:"flex items-center gap-1.5 sm:gap-2 bg-blue-50 px-2 sm:px-3 py-1 rounded-full w-fit shrink-0",children:[(0,t.jsx)(p.Eye,{size:14,className:"sm:w-4 sm:h-4 text-blue-600"}),(0,t.jsx)("span",{className:"text-blue-700 font-medium whitespace-nowrap",children:"Lượt xem"}),(0,t.jsx)("span",{className:"bg-blue-600 text-white font-bold px-1.5 sm:px-2 py-0.5 rounded-full text-xs shrink-0",children:j.views||0})]})]}),(0,t.jsxs)("div",{className:"prose prose-slate max-w-none mb-8 sm:mb-12",children:[(0,t.jsx)("h3",{className:"font-serif text-lg sm:text-xl font-bold text-[#0f294d] mb-3 sm:mb-4",children:"Giới thiệu sách"}),(0,t.jsx)("p",{className:"text-base sm:text-lg leading-relaxed text-slate-600 whitespace-pre-line",children:j.description})]}),(0,t.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 sm:p-6 md:p-8",children:[(0,t.jsxs)("h3",{className:"font-serif text-xl sm:text-2xl font-bold text-[#0f294d] mb-6 sm:mb-8 flex items-center gap-2 flex-wrap",children:["Bàn luận về sách",(0,t.jsx)("span",{className:"text-xs sm:text-sm font-normal text-slate-500 bg-white px-2 py-0.5 rounded-full border border-slate-200",children:j.comments.length})]}),(0,t.jsxs)("form",{onSubmit:I,className:"mb-8 sm:mb-10 bg-white p-4 sm:p-6 rounded-lg shadow-sm border border-slate-100",children:[(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1",children:"Tên của bạn"}),(0,t.jsx)("input",{type:"text",required:!0,value:R,onChange:e=>k(e.target.value),className:"w-full px-3 sm:px-4 py-2 text-sm sm:text-base border border-slate-300 rounded focus:ring-1 focus:ring-[#d4af37] focus:border-[#d4af37] outline-none transition-all",placeholder:"Nhập tên hiển thị..."})]}),(0,t.jsxs)("div",{className:"mb-3 sm:mb-4",children:[(0,t.jsx)("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1",children:"Nội dung bình luận"}),(0,t.jsx)("textarea",{required:!0,value:N,onChange:e=>C(e.target.value),rows:4,className:"w-full px-3 sm:px-4 py-2 text-sm sm:text-base border border-slate-300 rounded focus:ring-1 focus:ring-[#d4af37] focus:border-[#d4af37] outline-none transition-all resize-none",placeholder:"Chia sẻ cảm nghĩ của bạn về cuốn sách này..."})]}),(0,t.jsxs)("button",{type:"submit",className:"bg-[#0f294d] text-white px-4 sm:px-6 py-2 rounded text-sm sm:text-base font-medium hover:bg-slate-800 transition-colors flex items-center gap-2 w-full sm:w-auto justify-center",children:[(0,t.jsx)(d.Send,{size:16})," Gửi bình luận"]})]}),(0,t.jsx)("div",{className:"space-y-4 sm:space-y-6",children:0===j.comments.length?(0,t.jsx)("p",{className:"text-center text-slate-400 py-4 italic text-sm sm:text-base",children:"Chưa có bình luận nào. Hãy là người đầu tiên!"}):j.comments.map(e=>(0,t.jsxs)("div",{className:"flex gap-3 sm:gap-4",children:[(0,t.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-slate-200 flex items-center justify-center flex-shrink-0 text-slate-500",children:(0,t.jsx)(c.User,{size:16,className:"sm:w-5 sm:h-5"})}),(0,t.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,t.jsx)("span",{className:"font-bold text-slate-800 text-sm sm:text-base",children:e.user}),(0,t.jsxs)("span",{className:"text-xs text-slate-400",children:["• ",(e=>{try{let t=new Date(e),s=t.getDate(),r=t.getMonth()+1,i=t.getFullYear(),a=t.getHours().toString().padStart(2,"0"),n=t.getMinutes().toString().padStart(2,"0");return`${s} ${["tháng 1","tháng 2","tháng 3","tháng 4","tháng 5","tháng 6","tháng 7","tháng 8","tháng 9","tháng 10","tháng 11","tháng 12"][r-1]} ${i}, ${a}:${n}`}catch{return e}})(e.date)]})]}),(0,t.jsx)("p",{className:"text-slate-600 bg-white p-2.5 sm:p-3 rounded-br-xl rounded-bl-xl rounded-tr-xl border border-slate-100 shadow-sm inline-block text-sm sm:text-base break-words max-w-full",children:e.content})]})]},e.id))})]})]})]})}),S&&j.pdfUrl&&(0,t.jsxs)("div",{className:"fixed inset-0 z-[60] bg-slate-900 flex flex-col animate-in fade-in duration-200",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center px-4 py-3 bg-slate-900 text-white shadow-md border-b border-slate-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-8 h-8 rounded bg-white/10 flex items-center justify-center",children:(0,t.jsx)(h.BookOpen,{size:18})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-bold text-sm line-clamp-1",children:j.title}),(0,t.jsx)("span",{className:"text-xs text-slate-400",children:j.author})]})]}),(0,t.jsx)("button",{onClick:()=>O(!1),className:"p-2 hover:bg-red-500/20 hover:text-red-400 rounded-full transition-colors",children:(0,t.jsx)(f.X,{size:24})})]}),(0,t.jsx)("div",{className:"flex-grow overflow-hidden",children:(0,t.jsx)(g,{fileUrl:j.pdfUrl,onClose:()=>O(!1),title:j.title})})]})]})}e.s(["default",()=>y])},21993,e=>{e.v(t=>Promise.all(["static/chunks/22b62e0f3d9f3790.js","static/chunks/3c7d096865c62627.js","static/chunks/7fb7c50d0d037d13.css"].map(t=>e.l(t))).then(()=>t(36854)))}]);