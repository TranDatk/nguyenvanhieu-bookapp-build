module.exports=[63588,a=>{"use strict";let b=(0,a.i(70106).default)("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]);a.s(["MessageSquare",()=>b],63588)},53854,a=>{"use strict";var b=a.i(72131),c=a.i(33217),d=a.i(3159);let e={all:["practices"],lists:()=>[...e.all,"list"],list:a=>[...e.lists(),{filters:a}],details:()=>[...e.all,"detail"],detail:a=>[...e.details(),a]};async function f(){let a=await fetch("/api/practices");if(!a.ok)throw Error("Failed to fetch practices");return a.json()}function g(){let{setPractices:a}=(0,d.useDataStore)(),g=(0,c.useQuery)({queryKey:e.all,queryFn:f});return b.default.useEffect(()=>{g.data&&a(g.data)},[g.data,a]),g}a.s(["practiceKeys",0,e,"usePractices",()=>g])},91119,a=>{"use strict";var b=a.i(87924),c=a.i(68114);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card",className:(0,c.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",a),...d})}function e({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-header",className:(0,c.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",a),...d})}function f({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-title",className:(0,c.cn)("leading-none font-semibold",a),...d})}function g({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-description",className:(0,c.cn)("text-muted-foreground text-sm",a),...d})}function h({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"card-content",className:(0,c.cn)("px-6",a),...d})}a.s(["Card",()=>d,"CardContent",()=>h,"CardDescription",()=>g,"CardHeader",()=>e,"CardTitle",()=>f])},95598,a=>{"use strict";let b,c="0123456789abcdef";class d{constructor(a){this.bytes=a}static ofInner(a){if(16===a.length)return new d(a);throw TypeError("not 128-bit length")}static fromFieldsV7(a,b,c,e){if(!Number.isInteger(a)||!Number.isInteger(b)||!Number.isInteger(c)||!Number.isInteger(e)||a<0||b<0||c<0||e<0||a>0xffffffffffff||b>4095||c>0x3fffffff||e>0xffffffff)throw RangeError("invalid field value");let f=new Uint8Array(16);return f[0]=a/0x10000000000,f[1]=a/0x100000000,f[2]=a/0x1000000,f[3]=a/65536,f[4]=a/256,f[5]=a,f[6]=112|b>>>8,f[7]=b,f[8]=128|c>>>24,f[9]=c>>>16,f[10]=c>>>8,f[11]=c,f[12]=e>>>24,f[13]=e>>>16,f[14]=e>>>8,f[15]=e,new d(f)}static parse(a){var b,c,e,f;let g;switch(a.length){case 32:g=null==(b=/^[0-9a-f]{32}$/i.exec(a))?void 0:b[0];break;case 36:g=null==(c=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(a))?void 0:c.slice(1,6).join("");break;case 38:g=null==(e=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(a))?void 0:e.slice(1,6).join("");break;case 45:g=null==(f=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(a))?void 0:f.slice(1,6).join("")}if(g){let a=new Uint8Array(16);for(let b=0;b<16;b+=4){let c=parseInt(g.substring(2*b,2*b+8),16);a[b+0]=c>>>24,a[b+1]=c>>>16,a[b+2]=c>>>8,a[b+3]=c}return new d(a)}throw SyntaxError("could not parse UUID string")}toString(){let a="";for(let b=0;b<this.bytes.length;b++)a+=c.charAt(this.bytes[b]>>>4),a+=c.charAt(15&this.bytes[b]),(3===b||5===b||7===b||9===b)&&(a+="-");return a}toHex(){let a="";for(let b=0;b<this.bytes.length;b++)a+=c.charAt(this.bytes[b]>>>4),a+=c.charAt(15&this.bytes[b]);return a}toJSON(){return this.toString()}getVariant(){let a=this.bytes[8]>>>4;if(a<0)throw Error("unreachable");if(a<=7)return this.bytes.every(a=>0===a)?"NIL":"VAR_0";if(a<=11)return"VAR_10";if(a<=13)return"VAR_110";if(a<=15)return this.bytes.every(a=>255===a)?"MAX":"VAR_RESERVED";else throw Error("unreachable")}getVersion(){return"VAR_10"===this.getVariant()?this.bytes[6]>>>4:void 0}clone(){return new d(this.bytes.slice(0))}equals(a){return 0===this.compareTo(a)}compareTo(a){for(let b=0;b<16;b++){let c=this.bytes[b]-a.bytes[b];if(0!==c)return Math.sign(c)}return 0}}class e{constructor(a){this.timestamp_biased=0,this.counter=0,this.random=null!=a?a:f()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(a,b){let c=this.generateOrAbortCore(a,b);return void 0===c&&(this.timestamp_biased=0,c=this.generateOrAbortCore(a,b)),c}generateOrAbortCore(a,b){if(!Number.isInteger(a)||a<0||a>0xffffffffffff)throw RangeError("`unixTsMs` must be a 48-bit unsigned integer");if(b<0||b>0xffffffffffff)throw RangeError("`rollbackAllowance` out of reasonable range");if(++a>this.timestamp_biased)this.timestamp_biased=a,this.resetCounter();else{if(!(a+b>=this.timestamp_biased))return;this.counter++,this.counter>0x3ffffffffff&&(this.timestamp_biased++,this.resetCounter())}return d.fromFieldsV7(this.timestamp_biased-1,Math.trunc(this.counter/0x40000000),this.counter&0x40000000-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}generateV4(){let a=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return a[6]=64|a[6]>>>4,a[8]=128|a[8]>>>2,d.ofInner(a)}}let f=()=>{if("undefined"!=typeof crypto&&void 0!==crypto.getRandomValues)return new g;if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");return{nextUint32:()=>65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random())}};class g{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}function h(){return(b||(b=new e)).generate().toString()}a.s(["generateId",()=>h],95598)},52495,a=>{"use strict";let b=(0,a.i(70106).default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);a.s(["ExternalLink",()=>b],52495)},27081,a=>{"use strict";var b=a.i(72131);function c(){let[a,c]=(0,b.useState)(null),[d,e]=(0,b.useState)(!0);return(0,b.useEffect)(()=>{(async()=>{try{let a=await fetch("/api/users");if(a.ok){let b=(await a.json()).find(a=>"admin"===a.role);c(b||null)}}catch(a){console.error("Error fetching admin user:",a)}finally{e(!1)}})()},[]),{adminUser:a,isLoading:d}}a.s(["useAdminUser",()=>c])},41675,a=>{"use strict";let b=(0,a.i(70106).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],41675)},92759,a=>{"use strict";let b=(0,a.i(70106).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);a.s(["Send",()=>b],92759)},33988,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(53854),e=a.i(3159),f=a.i(37927),g=a.i(27081),h=a.i(69472),i=a.i(52495),j=a.i(41675);let k=(0,a.i(70106).default)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]]);var l=a.i(63588),m=a.i(92759),n=a.i(46842),o=a.i(91119),p=a.i(72233),q=a.i(95598);function r(){let{data:a=[],isLoading:c,refetch:h}=(0,d.usePractices)(),i=(0,e.useDataStore)(),j=(0,f.useQueryClient)(),{adminUser:k}=(0,g.useAdminUser)(),l=async(a,b)=>{try{if((await fetch("/api/practice-comments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceId:a,comment:b})})).ok)await j.invalidateQueries({queryKey:d.practiceKeys.all}),await h();else throw Error("Failed to add comment")}catch(a){throw console.error("Failed to add practice comment:",a),a}},m=async a=>{try{(await fetch("/api/practice-reactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceId:a,action:"add"})})).ok&&(await j.invalidateQueries({queryKey:d.practiceKeys.all}),await h())}catch(a){throw console.error("Failed to add practice reaction:",a),a}},n=async a=>{try{(await fetch("/api/practice-reactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({practiceId:a,action:"remove"})})).ok&&(await j.invalidateQueries({queryKey:d.practiceKeys.all}),await h())}catch(a){throw console.error("Failed to remove practice reaction:",a),a}},p=a.length>0?a:i.practices,q=a=>{if(a.includes("youtube.com/watch")||a.includes("youtu.be/")){let b=a.includes("youtu.be/")?a.split("youtu.be/")[1].split("?")[0]:a.split("v=")[1]?.split("&")[0];return`https://www.youtube.com/embed/${b}`}return a},r=a=>a.includes("youtube.com")||a.includes("youtu.be"),t=a=>a.includes("tiktok.com");return c?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Đang tải..."})]})}):(0,b.jsx)("div",{className:"min-h-screen bg-slate-50 py-8",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 max-w-3xl",children:[(0,b.jsxs)("div",{className:"mb-8 text-center",children:[(0,b.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold text-slate-900 mb-2",children:"Tập Luyện"}),(0,b.jsx)("p",{className:"text-slate-600",children:"Các bài tập luyện và video hướng dẫn"})]}),(0,b.jsx)("div",{className:"space-y-6",children:0===p.length?(0,b.jsx)(o.Card,{className:"p-12 text-center",children:(0,b.jsx)("p",{className:"text-slate-500",children:"Chưa có bài tập luyện nào"})}):p.map(a=>(0,b.jsx)(s,{practice:a,isYouTube:r,getVideoEmbedUrl:q,isTikTok:t,onAddComment:l,onAddReaction:m,onRemoveReaction:n,adminUser:k},a.id))})]})})}function s({practice:a,isYouTube:d,getVideoEmbedUrl:e,isTikTok:f,onAddComment:g,onAddReaction:o,onRemoveReaction:r,adminUser:s}){let t=d(a.videoUrl),u=f(a.videoUrl),[v,w]=(0,c.useState)(""),[x,y]=(0,c.useState)(""),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(()=>(a.id,!1)),D=async b=>{if(b.preventDefault(),v.trim()&&x.trim())try{await g(a.id,{id:(0,q.generateId)(),user:v.trim(),content:x.trim(),date:new Date().toISOString()}),w(""),y("")}catch(a){console.error("Error adding comment:",a),alert("Có lỗi xảy ra khi thêm bình luận. Vui lòng thử lại.")}},E=async()=>{try{B?(await r(a.id),a.id,C(!1)):(await o(a.id),a.id,C(!0))}catch(a){console.error("Error toggling reaction:",a)}};return(0,b.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow",children:[(0,b.jsx)("div",{className:"p-4 border-b border-slate-100",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(p.Avatar,{className:"h-12 w-12 border-2 border-slate-200",children:[(0,b.jsx)(p.AvatarImage,{src:s?.avatar,alt:s?.name||"Admin"}),(0,b.jsx)(p.AvatarFallback,{className:"bg-gradient-to-br from-[#0f294d] to-[#d4af37] text-white font-bold text-base",children:s?.name?.[0]?.toUpperCase()||s?.email?.[0]?.toUpperCase()||"A"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-bold text-slate-900 text-base",children:s?.name||"Admin"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-500 mt-0.5",children:[(0,b.jsx)(j.Calendar,{size:12}),(0,b.jsx)("span",{children:new Date(a.publishDate).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"})})]})]})]}),t&&(0,b.jsx)("div",{className:"flex items-center gap-1 text-red-600",children:(0,b.jsx)(h.Youtube,{size:20})})]})}),(0,b.jsxs)("div",{className:"px-4 pt-4 pb-2",children:[(0,b.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-3 leading-tight",children:a.title}),(0,b.jsx)("p",{className:"text-slate-700 leading-relaxed whitespace-pre-line text-[15px]",children:a.description})]}),(0,b.jsx)("div",{className:"bg-slate-900 my-2 mx-4 rounded-lg overflow-hidden",children:t?(0,b.jsx)("div",{className:"aspect-video",children:(0,b.jsx)("iframe",{src:e(a.videoUrl),className:"w-full h-full",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})}):u?(0,b.jsx)("div",{className:"aspect-[9/16] max-h-[600px] flex items-center justify-center bg-slate-800",children:(0,b.jsxs)("div",{className:"text-center p-8",children:[(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("svg",{viewBox:"0 0 24 24",className:"w-16 h-16 mx-auto text-white",fill:"currentColor",children:(0,b.jsx)("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"})})}),(0,b.jsx)("p",{className:"text-white mb-4",children:"Video TikTok"}),(0,b.jsxs)("a",{href:a.videoUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 bg-white text-slate-900 rounded-lg font-medium hover:bg-slate-100 transition-colors",children:[(0,b.jsx)(i.ExternalLink,{size:18}),"Xem trên TikTok"]})]})}):(0,b.jsx)("div",{className:"aspect-video flex items-center justify-center bg-slate-800",children:(0,b.jsxs)("a",{href:a.videoUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-6 py-3 bg-white text-slate-900 rounded-lg font-medium hover:bg-slate-100 transition-colors",children:[(0,b.jsx)(i.ExternalLink,{size:18}),"Xem video"]})})}),(a.reactions||0)>0&&(0,b.jsx)("div",{className:"px-4 py-2 border-t border-slate-100",children:(0,b.jsxs)("div",{className:"flex items-center gap-2 text-slate-600 text-sm",children:[(0,b.jsx)("div",{className:"w-5 h-5 rounded-full bg-red-500 flex items-center justify-center",children:(0,b.jsx)(k,{size:12,className:"text-white fill-white"})}),(0,b.jsx)("span",{className:"font-medium",children:a.reactions})]})}),(0,b.jsxs)("div",{className:"px-4 py-2 border-t border-slate-100",children:[(0,b.jsxs)("div",{className:"flex items-center justify-around",children:[(0,b.jsxs)("button",{onClick:E,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors flex-1 justify-center group ${B?"text-red-500 hover:bg-red-50":"hover:bg-slate-50 text-slate-700"}`,children:[(0,b.jsx)(k,{size:20,className:`transition-colors ${B?"text-red-500 fill-red-500":"text-slate-500 group-hover:text-red-500"}`}),(0,b.jsx)("span",{className:"font-medium text-sm",children:B?"Đã thích":"Thích"})]}),(0,b.jsxs)("button",{onClick:()=>A(!z),className:"flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-slate-50 transition-colors text-slate-700 flex-1 justify-center group",children:[(0,b.jsx)(l.MessageSquare,{size:20,className:"group-hover:text-blue-500 transition-colors"}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"Bình luận"})]}),(0,b.jsxs)("a",{href:a.videoUrl,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-4 py-2 rounded-lg hover:bg-slate-50 transition-colors text-blue-600 hover:text-blue-700 flex-1 justify-center",children:[(0,b.jsx)(i.ExternalLink,{size:18}),(0,b.jsx)("span",{className:"font-medium text-sm",children:"Mở video"})]})]}),z&&(0,b.jsxs)("div",{className:"px-4 py-3 border-t border-slate-100 bg-slate-50",children:[(0,b.jsxs)("h4",{className:"font-semibold text-slate-900 mb-4 text-sm",children:["Bình luận (",(a.comments||[]).length,")"]}),(0,b.jsxs)("form",{onSubmit:D,className:"mb-4 bg-white p-3 rounded-lg border border-slate-200",children:[(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)("input",{type:"text",required:!0,value:v,onChange:a=>w(a.target.value),className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-sm",placeholder:"Tên của bạn..."})}),(0,b.jsx)("div",{className:"mb-2",children:(0,b.jsx)("textarea",{required:!0,value:x,onChange:a=>y(a.target.value),rows:3,className:"w-full px-3 py-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all text-sm resize-none",placeholder:"Viết bình luận..."})}),(0,b.jsxs)("button",{type:"submit",className:"bg-blue-600 text-white px-4 py-2 rounded-md font-medium hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm w-full justify-center",children:[(0,b.jsx)(m.Send,{size:16})," Gửi bình luận"]})]}),(0,b.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===(a.comments||[]).length?(0,b.jsx)("p",{className:"text-center text-slate-400 py-6 italic text-sm",children:"Chưa có bình luận nào. Hãy là người đầu tiên!"}):(a.comments||[]).map(a=>(0,b.jsxs)("div",{className:"flex gap-3 bg-white p-3 rounded-lg border border-slate-200",children:[(0,b.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center shrink-0",children:(0,b.jsx)(n.User,{size:18,className:"text-white"})}),(0,b.jsxs)("div",{className:"grow min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("span",{className:"font-semibold text-slate-800 text-sm",children:a.user}),(0,b.jsxs)("span",{className:"text-xs text-slate-400",children:["• ",(a=>{try{let b=new Date(a),c=new Date().getTime()-b.getTime(),d=Math.floor(c/6e4),e=Math.floor(c/36e5),f=Math.floor(c/864e5);if(d<1)return"Vừa xong";if(d<60)return`${d} ph\xfat trước`;if(e<24)return`${e} giờ trước`;if(f<7)return`${f} ng\xe0y trước`;if(a.includes("T")||a.includes(" "))return b.toLocaleString("vi-VN",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return b.toLocaleDateString("vi-VN",{year:"numeric",month:"short",day:"numeric"})}catch{return a}})(a.date)]})]}),(0,b.jsx)("p",{className:"text-slate-700 text-sm leading-relaxed break-words",children:a.content})]})]},a.id))})]})]})]})}a.s(["default",()=>r],33988)}];

//# sourceMappingURL=_d772cb74._.js.map