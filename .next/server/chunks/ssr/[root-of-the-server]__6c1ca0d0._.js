module.exports=[22734,(a,b,c)=>{b.exports=a.x("fs",()=>require("fs"))},24868,(a,b,c)=>{b.exports=a.x("fs/promises",()=>require("fs/promises"))},56712,a=>{"use strict";let b,c="0123456789abcdef";class d{constructor(a){this.bytes=a}static ofInner(a){if(16===a.length)return new d(a);throw TypeError("not 128-bit length")}static fromFieldsV7(a,b,c,e){if(!Number.isInteger(a)||!Number.isInteger(b)||!Number.isInteger(c)||!Number.isInteger(e)||a<0||b<0||c<0||e<0||a>0xffffffffffff||b>4095||c>0x3fffffff||e>0xffffffff)throw RangeError("invalid field value");let f=new Uint8Array(16);return f[0]=a/0x10000000000,f[1]=a/0x100000000,f[2]=a/0x1000000,f[3]=a/65536,f[4]=a/256,f[5]=a,f[6]=112|b>>>8,f[7]=b,f[8]=128|c>>>24,f[9]=c>>>16,f[10]=c>>>8,f[11]=c,f[12]=e>>>24,f[13]=e>>>16,f[14]=e>>>8,f[15]=e,new d(f)}static parse(a){var b,c,e,f;let g;switch(a.length){case 32:g=null==(b=/^[0-9a-f]{32}$/i.exec(a))?void 0:b[0];break;case 36:g=null==(c=/^([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(a))?void 0:c.slice(1,6).join("");break;case 38:g=null==(e=/^\{([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})\}$/i.exec(a))?void 0:e.slice(1,6).join("");break;case 45:g=null==(f=/^urn:uuid:([0-9a-f]{8})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{4})-([0-9a-f]{12})$/i.exec(a))?void 0:f.slice(1,6).join("")}if(g){let a=new Uint8Array(16);for(let b=0;b<16;b+=4){let c=parseInt(g.substring(2*b,2*b+8),16);a[b+0]=c>>>24,a[b+1]=c>>>16,a[b+2]=c>>>8,a[b+3]=c}return new d(a)}throw SyntaxError("could not parse UUID string")}toString(){let a="";for(let b=0;b<this.bytes.length;b++)a+=c.charAt(this.bytes[b]>>>4),a+=c.charAt(15&this.bytes[b]),(3===b||5===b||7===b||9===b)&&(a+="-");return a}toHex(){let a="";for(let b=0;b<this.bytes.length;b++)a+=c.charAt(this.bytes[b]>>>4),a+=c.charAt(15&this.bytes[b]);return a}toJSON(){return this.toString()}getVariant(){let a=this.bytes[8]>>>4;if(a<0)throw Error("unreachable");if(a<=7)return this.bytes.every(a=>0===a)?"NIL":"VAR_0";if(a<=11)return"VAR_10";if(a<=13)return"VAR_110";if(a<=15)return this.bytes.every(a=>255===a)?"MAX":"VAR_RESERVED";else throw Error("unreachable")}getVersion(){return"VAR_10"===this.getVariant()?this.bytes[6]>>>4:void 0}clone(){return new d(this.bytes.slice(0))}equals(a){return 0===this.compareTo(a)}compareTo(a){for(let b=0;b<16;b++){let c=this.bytes[b]-a.bytes[b];if(0!==c)return Math.sign(c)}return 0}}class e{constructor(a){this.timestamp_biased=0,this.counter=0,this.random=null!=a?a:f()}generate(){return this.generateOrResetCore(Date.now(),1e4)}generateOrAbort(){return this.generateOrAbortCore(Date.now(),1e4)}generateOrResetCore(a,b){let c=this.generateOrAbortCore(a,b);return void 0===c&&(this.timestamp_biased=0,c=this.generateOrAbortCore(a,b)),c}generateOrAbortCore(a,b){if(!Number.isInteger(a)||a<0||a>0xffffffffffff)throw RangeError("`unixTsMs` must be a 48-bit unsigned integer");if(b<0||b>0xffffffffffff)throw RangeError("`rollbackAllowance` out of reasonable range");if(++a>this.timestamp_biased)this.timestamp_biased=a,this.resetCounter();else{if(!(a+b>=this.timestamp_biased))return;this.counter++,this.counter>0x3ffffffffff&&(this.timestamp_biased++,this.resetCounter())}return d.fromFieldsV7(this.timestamp_biased-1,Math.trunc(this.counter/0x40000000),this.counter&0x40000000-1,this.random.nextUint32())}resetCounter(){this.counter=1024*this.random.nextUint32()+(1023&this.random.nextUint32())}generateV4(){let a=new Uint8Array(Uint32Array.of(this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32(),this.random.nextUint32()).buffer);return a[6]=64|a[6]>>>4,a[8]=128|a[8]>>>2,d.ofInner(a)}}let f=()=>{if("undefined"!=typeof crypto&&void 0!==crypto.getRandomValues)return new g;if("undefined"!=typeof UUIDV7_DENY_WEAK_RNG&&UUIDV7_DENY_WEAK_RNG)throw Error("no cryptographically strong RNG available");return{nextUint32:()=>65536*Math.trunc(65536*Math.random())+Math.trunc(65536*Math.random())}};class g{constructor(){this.buffer=new Uint32Array(8),this.cursor=65535}nextUint32(){return this.cursor>=this.buffer.length&&(crypto.getRandomValues(this.buffer),this.cursor=0),this.buffer[this.cursor++]}}function h(){return(b||(b=new e)).generate().toString()}a.s(["generateId",()=>h],56712)},30774,a=>{"use strict";var b=a.i(50340),c=a.i(11043),d=a.i(66517),e=a.i(32114),f=a.i(24868),g=a.i(14747),h=a.i(22734),i=a.i(56712);async function j(a){try{let b=a.get("title"),c=a.get("author"),f=a.get("category"),g=a.get("imageUrl"),h=a.get("pdfUrl"),j=a.get("description");if(!b||!b.trim())return{success:!1,error:"Vui lòng nhập tiêu đề sách"};if(!c||!c.trim())return{success:!1,error:"Vui lòng nhập tên tác giả"};if(!f||!f.trim())return{success:!1,error:"Vui lòng chọn thể loại"};if(!g||!g.trim())return{success:!1,error:"Vui lòng tải ảnh bìa hoặc nhập URL ảnh"};if(!h||!h.trim())return{success:!1,error:"Vui lòng tải file PDF hoặc nhập URL PDF"};let k={id:(0,i.generateId)(),title:b.trim(),author:c.trim(),category:f.trim(),coverUrl:g.trim(),pdfUrl:h.trim(),description:j?.trim()||"",publishDate:new Date().toISOString().split("T")[0],views:0,comments:[]};return await (0,e.addBook)(k),(0,d.revalidatePath)("/admin/books"),{success:!0}}catch(a){return console.error("Error creating book:",a),{success:!1,error:"Failed to create book"}}}async function k(a,b){try{let c={title:b.get("title"),author:b.get("author")||"Nguyễn Văn Hiếu",category:b.get("category")||"Sách",coverUrl:b.get("imageUrl")||`https://picsum.photos/seed/${Date.now()}/300/450`,pdfUrl:b.get("pdfUrl")||void 0,description:b.get("description")||""};return await (0,e.updateBook)(a,c),(0,d.revalidatePath)("/admin/books"),{success:!0}}catch(a){return console.error("Error updating book:",a),{success:!1,error:"Failed to update book"}}}async function l(a){if(a&&(a.startsWith("/pdf/")||a.startsWith("/images/")))try{let b=g.default.join(process.cwd(),"public",a);(0,h.existsSync)(b)&&(await (0,f.unlink)(b),console.log(`Deleted file: ${b}`))}catch(b){console.error(`Error deleting file ${a}:`,b)}}async function m(a){if(a&&a.startsWith("/pdf/"))try{let b=g.default.basename(a,".pdf"),c=g.default.join(process.cwd(),"public","pdf-pages",b);(0,h.existsSync)(c)&&(await (0,f.rm)(c,{recursive:!0,force:!0}),console.log(`Deleted processed PDF pages directory: ${c}`))}catch(b){console.error(`Error deleting processed PDF pages for ${a}:`,b)}}async function n(a){try{let b=(await (0,e.getBooks)()).find(b=>b.id===a);return b&&(b.pdfUrl&&(await l(b.pdfUrl),await m(b.pdfUrl)),b.coverUrl&&await l(b.coverUrl)),await (0,e.deleteBook)(a),(0,d.revalidatePath)("/admin/books"),{success:!0}}catch(a){return console.error("Error deleting book:",a),{success:!1,error:"Failed to delete book"}}}(0,a.i(27208).ensureServerEntryExports)([j,k,n]),(0,c.registerServerReference)(j,"40358f6b30c8131576b5ba9a803bc11d215db2d3b4",null),(0,c.registerServerReference)(k,"60f4c4e99c3b3fdd1d9f4302cafb7b50ecf02272f4",null),(0,c.registerServerReference)(n,"40665f823f2248495a041ae484defce00386628db4",null),a.s([],62183),a.i(62183),a.s(["0074aea2f47451b71d84fa3da6cb5c390a09741a06",()=>b.initAdminUser,"40358f6b30c8131576b5ba9a803bc11d215db2d3b4",()=>j,"40665f823f2248495a041ae484defce00386628db4",()=>n,"60f4c4e99c3b3fdd1d9f4302cafb7b50ecf02272f4",()=>k],30774)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__6c1ca0d0._.js.map