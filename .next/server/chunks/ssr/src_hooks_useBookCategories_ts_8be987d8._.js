module.exports=[59922,49625,97651,a=>{"use strict";var b=a.i(72131),c=a.i(33217),d=a.i(70025),e=a.i(37927),f=a.i(3159);let g=["book-categories"];async function h(){let a=await fetch("/api/book-categories");if(!a.ok)throw Error("Failed to fetch book categories");return a.json()}async function i(a){let b=await fetch("/api/book-categories",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({category:a})});if(!b.ok)throw Error((await b.json().catch(()=>({error:"Failed to create book category"}))).error||"Failed to create book category")}async function j({oldCategory:a,newCategory:b}){let c=await fetch("/api/book-categories",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldCategory:a,newCategory:b})});if(!c.ok)throw Error((await c.json().catch(()=>({error:"Failed to update book category"}))).error||"Failed to update book category")}async function k(a){let b=await fetch(`/api/book-categories?category=${encodeURIComponent(a)}`,{method:"DELETE"});if(!b.ok)throw Error((await b.json().catch(()=>({error:"Failed to delete book category"}))).error||"Failed to delete book category")}function l(){let{setBookCategories:a}=(0,f.useDataStore)(),d=(0,c.useQuery)({queryKey:g,queryFn:h});return b.default.useEffect(()=>{d.data&&a(d.data)},[d.data,a]),d}function m(){let a=(0,e.useQueryClient)(),{addBookCategory:b}=(0,f.useDataStore)();return(0,d.useMutation)({mutationFn:i,onSuccess:(c,d)=>{b(d),a.invalidateQueries({queryKey:g})},onError:a=>{console.error("Failed to create book category:",a)}})}function n(){let a=(0,e.useQueryClient)(),{updateBookCategory:b}=(0,f.useDataStore)();return(0,d.useMutation)({mutationFn:j,onSuccess:(c,d)=>{b(d.oldCategory,d.newCategory),a.invalidateQueries({queryKey:g})},onError:a=>{console.error("Failed to update book category:",a)}})}function o(){let a=(0,e.useQueryClient)(),{deleteBookCategory:b}=(0,f.useDataStore)();return(0,d.useMutation)({mutationFn:k,onSuccess:(c,d)=>{b(d),a.invalidateQueries({queryKey:g})},onError:a=>{console.error("Failed to delete book category:",a)}})}a.s(["useBookCategories",()=>l,"useCreateBookCategory",()=>m,"useDeleteBookCategory",()=>o,"useUpdateBookCategory",()=>n],59922);var p=a.i(87924),q=a.i(95598);function r(a){if(0===a)return"0 Bytes";let b=Math.floor(Math.log(a)/Math.log(1024));return Math.round(a/Math.pow(1024,b)*100)/100+" "+["Bytes","KB","MB","GB"][b]}var s=a.i(99570),t=a.i(85259),u=a.i(70106);let v=(0,u.default)("cloud-upload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]),w=(0,u.default)("file-archive",[["path",{d:"M13.659 22H18a2 2 0 0 0 2-2V8a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 14 2H6a2 2 0 0 0-2 2v11.5",key:"4pqfef"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 12v-1",key:"1ej8lb"}],["path",{d:"M8 18v-2",key:"qcmpov"}],["path",{d:"M8 7V6",key:"1nbb54"}],["circle",{cx:"8",cy:"20",r:"2",key:"ckkr5m"}]]),x=(0,u.default)("file-spreadsheet",[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);var y=a.i(2769),y=y;let z=(0,u.default)("headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),A=(0,u.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);a.s(["default",()=>A],49625);let B=(0,u.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var C=a.i(81560),D=a.i(73320);let E=(0,u.default)("video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);var F=a.i(22262),G=a.i(68114),H=a.i(23292);function I({maxFiles:a=10,maxSize:c=0x3200000,accept:d="*",multiple:e=!0,className:f,onFilesChange:g,simulateUpload:h=!0,onUploadProgress:i}){let[j,k]=(0,b.useState)([]),{isDragging:l,errors:m,removeFile:n,clearFiles:o,handleDragEnter:u,handleDragLeave:I,handleDragOver:J,handleDrop:K,openFileDialog:L,getInputProps:M}=function({maxFiles:a=10,maxSize:c=0x3200000,accept:d="*",multiple:e=!0,initialFiles:f=[],onFilesChange:g}){let[h,i]=(0,b.useState)(!1),[j,k]=(0,b.useState)([]),[l,m]=(0,b.useState)(()=>f.map(a=>({id:a.id,file:a,preview:a.url||""}))),n=(0,b.useRef)(0),o=(0,b.useRef)(null),p=a=>{if(a.size>c)return`File "${a.name}" vượt qu\xe1 k\xedch thước tối đa ${r(c)}`;if("*"!==d){let b=d.split(",").map(a=>a.trim()),c="."+a.name.split(".").pop()?.toLowerCase(),e=a.type.toLowerCase();if(!b.some(a=>{if(a.includes("/")&&e===a.toLowerCase()||a.startsWith(".")&&c===a.toLowerCase())return!0;if(a.endsWith("/*")){let b=a.split("/")[0];if(e.startsWith(b+"/"))return!0}return!1}))return`File "${a.name}" kh\xf4ng phải l\xe0 định dạng được chấp nhận. Chấp nhận: ${b.join(", ")}`}return null},s=(0,b.useCallback)(async b=>{let c=Array.from(b),d=[],e=[];for(let a of c){let b=p(a);b?d.push(b):e.push(a)}l.length+e.length>a&&(d.push(`Chỉ cho ph\xe9p tối đa ${a} file`),e.splice(a-l.length)),k(d);let f=[...l,...await Promise.all(e.map(async a=>{let b=await new Promise(b=>{if(a.type.startsWith("image/")){let c=new FileReader;c.onload=a=>b(a.target?.result),c.readAsDataURL(a)}else b("")});return{id:(0,q.generateId)(),file:a,preview:b}}))];m(f),g?.(f)},[l,a,c,d,g]),t=(0,b.useCallback)(a=>{let b=l.filter(b=>b.id!==a);m(b),g?.(b)},[l,g]),u=(0,b.useCallback)(()=>{m([]),g?.([])},[g]),v=(0,b.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),n.current++,a.dataTransfer.items&&a.dataTransfer.items.length>0&&i(!0)},[]),w=(0,b.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),n.current--,0===n.current&&i(!1)},[]),x=(0,b.useCallback)(a=>{a.preventDefault(),a.stopPropagation()},[]),y=(0,b.useCallback)(a=>{a.preventDefault(),a.stopPropagation(),i(!1),n.current=0,a.dataTransfer.files&&a.dataTransfer.files.length>0&&s(a.dataTransfer.files)},[s]),z=(0,b.useCallback)(()=>{o.current?.click()},[]),A=(0,b.useCallback)(a=>{a.target.files&&a.target.files.length>0&&(s(a.target.files),o.current&&(o.current.value=""))},[s]);return{isDragging:h,errors:j,removeFile:t,clearFiles:u,handleDragEnter:v,handleDragLeave:w,handleDragOver:x,handleDrop:y,openFileDialog:z,getInputProps:(0,b.useCallback)(()=>({ref:o,type:"file",accept:d,multiple:e,onChange:A,style:{display:"none"}}),[d,e,A])}}({maxFiles:a,maxSize:c,accept:d,multiple:e,initialFiles:[],onFilesChange:a=>{let b=a.map(a=>{let b=j.find(b=>b.id===a.id);return b?{...b,...a}:{...a,progress:0,status:"uploading"}});k(b),g?.(b)}});(0,b.useEffect)(()=>{m.length>0&&m.forEach(a=>{H.toast.error(a)})},[m]);let N=(0,b.useRef)(new Map);(0,b.useEffect)(()=>{if(i){window.__cardUploadProgressHandlers||(window.__cardUploadProgressHandlers=new Map);let a=window.__cardUploadProgressHandlers;j.forEach(b=>{if("uploading"===b.status){let c=a=>{k(c=>c.map(c=>c.id!==b.id||"uploading"!==c.status?c:a>=100?{...c,progress:100,status:"completed"}:{...c,progress:a}))};N.current.set(b.id,c),a.set(b.id,c)}});let b=new Set(j.map(a=>a.id));return N.current.forEach((c,d)=>{b.has(d)||(N.current.delete(d),a.delete(d))}),window.__updateCardUploadProgress||(window.__updateCardUploadProgress=(b,c)=>{let d=a.get(b);d&&d(c)}),()=>{j.forEach(b=>{a.delete(b.id)})}}},[j,i]),(0,b.useEffect)(()=>{if(!h||i||0===j.filter(a=>"uploading"===a.status).length)return;let a=setInterval(()=>{k(a=>a.map(a=>{if("uploading"!==a.status)return a;let b=20*Math.random()+5,c=Math.min(a.progress+b,100);if(c>=100){let b=.1>Math.random();return{...a,progress:100,status:b?"error":"completed",error:b?"Tải lên thất bại. Vui lòng thử lại.":void 0}}return{...a,progress:c}}))},500);return()=>clearInterval(a)},[j,h,i]);let O=a=>{let b=(a instanceof File,a.type);return b.startsWith("image/")?(0,p.jsx)(A,{className:"size-6"}):b.startsWith("video/")?(0,p.jsx)(E,{className:"size-6"}):b.startsWith("audio/")?(0,p.jsx)(z,{className:"size-6"}):b.includes("pdf")||b.includes("word")||b.includes("doc")?(0,p.jsx)(y.default,{className:"size-6"}):b.includes("excel")||b.includes("sheet")?(0,p.jsx)(x,{className:"size-6"}):b.includes("zip")||b.includes("rar")?(0,p.jsx)(w,{className:"size-6"}):(0,p.jsx)(y.default,{className:"size-6"})};return(0,p.jsxs)("div",{className:(0,G.cn)("w-full space-y-4",f),children:[(0,p.jsxs)("div",{className:(0,G.cn)("relative rounded-lg border border-dashed p-6 text-center transition-colors",l?"border-primary bg-primary/5":"border-muted-foreground/25 hover:border-muted-foreground/50"),onDragEnter:u,onDragLeave:I,onDragOver:J,onDrop:K,children:[(0,p.jsx)("input",{...M(),className:"sr-only"}),(0,p.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,p.jsx)("div",{className:(0,G.cn)("flex h-12 w-12 items-center justify-center rounded-full bg-muted transition-colors",l?"border-primary bg-primary/10":"border-muted-foreground/25"),children:(0,p.jsx)(D.Upload,{className:"h-5 w-5 text-muted-foreground"})}),(0,p.jsxs)("div",{className:"space-y-2",children:[(0,p.jsxs)("p",{className:"text-sm font-medium",children:["Kéo thả file vào đây hoặc"," ",(0,p.jsx)("button",{type:"button",onClick:L,className:"cursor-pointer text-primary underline-offset-4 hover:underline",children:"chọn file"})]}),(0,p.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Kích thước file tối đa: ",r(c)," • Số file tối đa: ",a]})]})]})]}),j.length>0&&(0,p.jsxs)("div",{className:"space-y-4",children:[(0,p.jsxs)("div",{className:"flex items-center justify-between",children:[(0,p.jsxs)("h3",{className:"text-sm font-medium",children:["Tệp tin (",j.length,")"]}),a>1&&(0,p.jsxs)("div",{className:"flex gap-2",children:[(0,p.jsxs)(s.Button,{onClick:L,variant:"outline",size:"sm",children:[(0,p.jsx)(v,{}),"Thêm file"]}),(0,p.jsxs)(s.Button,{onClick:o,variant:"outline",size:"sm",children:[(0,p.jsx)(C.Trash2,{}),"Xóa tất cả"]})]})]}),(0,p.jsx)("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3 lg:grid-cols-4",children:j.map(a=>(0,p.jsxs)("div",{className:"relative group",children:[(0,p.jsx)(s.Button,{onClick:()=>{var b;let c;return b=a.id,void((c=j.find(a=>a.id===b))&&n(c.id))},variant:"outline",size:"icon",className:"absolute -end-2 -top-2 z-10 size-6 rounded-full opacity-0 transition-opacity group-hover:opacity-100",children:(0,p.jsx)(F.XIcon,{className:"size-3"})}),(0,p.jsxs)("div",{className:"relative overflow-hidden rounded-lg border bg-card transition-colors",children:[(0,p.jsx)("div",{className:"relative aspect-square bg-muted border-b border-border",children:a.file.type.startsWith("image/")&&a.preview?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("img",{src:a.preview,alt:a.file.name,className:"h-full w-full object-cover"}),"uploading"===a.status&&(0,p.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50",children:(0,p.jsx)("div",{className:"relative",children:(0,p.jsxs)("svg",{className:"size-12 -rotate-90",viewBox:"0 0 48 48",children:[(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-muted/60"}),(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${2*Math.PI*20}`,strokeDashoffset:`${2*Math.PI*20*(1-a.progress/100)}`,className:"text-white transition-all duration-300",strokeLinecap:"round"})]})})})]}):(0,p.jsx)("div",{className:"flex h-full items-center justify-center text-muted-foreground/80",children:"uploading"===a.status?(0,p.jsxs)("div",{className:"relative",children:[(0,p.jsxs)("svg",{className:"size-12 -rotate-90",viewBox:"0 0 48 48",children:[(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-muted-foreground/20"}),(0,p.jsx)("circle",{cx:"24",cy:"24",r:"20",fill:"none",stroke:"currentColor",strokeWidth:"3",strokeDasharray:`${2*Math.PI*20}`,strokeDashoffset:`${2*Math.PI*20*(1-a.progress/100)}`,className:"text-primary transition-all duration-300",strokeLinecap:"round"})]}),(0,p.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:O(a.file)})]}):(0,p.jsx)("div",{className:"text-4xl",children:O(a.file)})})}),(0,p.jsx)("div",{className:"p-3",children:(0,p.jsxs)("div",{className:"space-y-1",children:[(0,p.jsx)("p",{className:"truncate text-sm font-medium",children:a.file.name}),(0,p.jsxs)("div",{className:"relative flex items-center justify-between gap-2",children:[(0,p.jsx)("span",{className:"text-xs text-muted-foreground",children:r(a.file.size)}),"error"===a.status&&a.error&&(0,p.jsxs)(t.Tooltip,{children:[(0,p.jsx)(t.TooltipTrigger,{asChild:!0,children:(0,p.jsx)(s.Button,{onClick:()=>{var b;return b=a.id,void k(a=>a.map(a=>a.id===b?{...a,progress:0,status:"uploading",error:void 0}:a))},variant:"ghost",size:"icon",className:"absolute end-0 -top-1.25 size-6 text-destructive hover:bg-destructive/10 hover:text-destructive",children:(0,p.jsx)(B,{className:"size-3 opacity-100"})})}),(0,p.jsx)(t.TooltipContent,{children:"Tải lên thất bại. Thử lại"})]})]})]})})]})]},a.id))})]})]})}a.s(["default",()=>I],97651)}];

//# sourceMappingURL=src_hooks_useBookCategories_ts_8be987d8._.js.map